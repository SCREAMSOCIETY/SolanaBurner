/*! For license information please see app.js.LICENSE.txt */
(()=>{var e,t,n,r,o,a={13086:()=>{},15340:()=>{},20390:()=>{"undefined"!=typeof window&&(window.ActivityLogger=class{static STORAGE_KEY="solburnt-recent-activity";static MAX_ACTIVITIES=50;static logActivity(e,t,n,r,o=null){try{const a={type:e,title:t,description:n,recovery:parseFloat(r)||0,time:this.formatTimeAgo(new Date),timestamp:Date.now(),signature:o},s=this.getActivities();s.unshift(a);const i=s.slice(0,this.MAX_ACTIVITIES);localStorage.setItem(this.STORAGE_KEY,JSON.stringify(i)),console.log(`[Activity Logger] Logged ${e}: ${t} (+${r} SOL)`)}catch(e){console.error("[Activity Logger] Failed to log activity:",e)}}static getActivities(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):[]}catch{return[]}}static getRecentActivities(){const e=this.getActivities(),t=Date.now()-864e5;return e.filter((e=>e.timestamp>t)).slice(0,10)}static getTotalRecoveredToday(){return this.getRecentActivities().reduce(((e,t)=>e+(t.recovery||0)),0)}static clearActivities(){localStorage.removeItem(this.STORAGE_KEY)}static formatTimeAgo(e){const t=(new Date).getTime()-e.getTime(),n=Math.floor(t/6e4),r=Math.floor(t/36e5),o=Math.floor(t/864e5);return n<1?"just now":n<60?`${n}m ago`:r<24?`${r}h ago`:`${o}d ago`}static logNFTBurn(e,t,n){this.logActivity("nft-burn","NFT Burned",e,t,n)}static logTokenBurn(e,t,n){this.logActivity("token-burn","Token Burned",e,t,n)}static logVacantBurn(e,t,n){this.logActivity("vacant-burn","Vacant Accounts Cleared",`${e} empty token accounts`,t,n)}static logNFTResize(e,t,n){this.logActivity("resize","NFT Resized",e,t,n)}static logBatchBurn(e,t,n,r){this.logActivity("batch-burn",`Batch ${t} Burn`,`${e} ${t}s processed`,n,r)}})},21638:()=>{},29122:()=>{},29280:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(31601),o=n.n(r),a=n(76314),s=n.n(a)()(o());s.push([e.id,".delegated-transfer-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  background-color: rgba(0, 0, 0, 0.75);\n  backdrop-filter: blur(5px);\n}\n\n.delegated-transfer-content {\n  background-color: #1a1a2e;\n  padding: 30px;\n  border-radius: 16px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n  color: white;\n  position: relative;\n  max-height: 85vh;\n  overflow-y: auto;\n  border: 1px solid #3c3c5e;\n}\n\n.delegated-transfer-header {\n  margin-bottom: 20px;\n  text-align: center;\n}\n\n.delegated-transfer-header h2 {\n  margin: 0;\n  color: #e6e6ff;\n  font-size: 24px;\n}\n\n.delegated-transfer-close {\n  position: absolute;\n  top: 15px;\n  right: 15px;\n  background: transparent;\n  border: none;\n  color: #a0a0c0;\n  font-size: 24px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 36px;\n  height: 36px;\n  border-radius: 50%;\n  transition: background-color 0.2s, color 0.2s;\n}\n\n.delegated-transfer-close:hover {\n  background-color: rgba(255, 255, 255, 0.1);\n  color: white;\n}\n\n.delegated-transfer-asset {\n  display: flex;\n  align-items: center;\n  margin-bottom: 20px;\n  padding: 15px;\n  background-color: rgba(255, 255, 255, 0.05);\n  border-radius: 10px;\n}\n\n.delegated-transfer-asset-image {\n  width: 80px;\n  height: 80px;\n  border-radius: 10px;\n  margin-right: 15px;\n  object-fit: contain;\n  background-color: rgba(255, 255, 255, 0.1);\n}\n\n.delegated-transfer-asset-info h3 {\n  margin: 0 0 5px 0;\n  color: white;\n}\n\n.delegated-transfer-message {\n  margin-bottom: 20px;\n  line-height: 1.5;\n  color: #c0c0e0;\n}\n\n.delegated-transfer-buttons {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.delegated-transfer-button {\n  padding: 12px;\n  border: none;\n  border-radius: 8px;\n  font-weight: bold;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.2s, transform 0.1s;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.delegated-transfer-button:active {\n  transform: scale(0.98);\n}\n\n.delegated-transfer-button.primary {\n  background-color: #4d61fc;\n  color: white;\n}\n\n.delegated-transfer-button.primary:hover {\n  background-color: #5d71ff;\n}\n\n.delegated-transfer-button.secondary {\n  background-color: transparent;\n  color: #9090b0;\n  border: 1px solid #9090b0;\n}\n\n.delegated-transfer-button.secondary:hover {\n  background-color: rgba(144, 144, 176, 0.1);\n  color: white;\n  border-color: white;\n}\n\n.delegated-transfer-status {\n  margin-top: 20px;\n  padding: 15px;\n  border-radius: 8px;\n  background-color: rgba(255, 255, 255, 0.05);\n}\n\n.delegated-transfer-status.error {\n  background-color: rgba(255, 59, 48, 0.15);\n  color: #ff6b6b;\n}\n\n.delegated-transfer-status.success {\n  background-color: rgba(52, 199, 89, 0.15);\n  color: #4cd964;\n}\n\n.delegated-transfer-loading {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  margin: 20px 0;\n}\n\n.delegated-transfer-spinner {\n  width: 40px;\n  height: 40px;\n  border: 4px solid rgba(255, 255, 255, 0.1);\n  border-left-color: #4d61fc;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n  margin-bottom: 15px;\n}\n\n@keyframes spin {\n  to {\n    transform: rotate(360deg);\n  }\n}\n\n.delegated-transfer-explorer-link {\n  display: inline-block;\n  margin-top: 10px;\n  color: #4d61fc;\n  text-decoration: none;\n}\n\n.delegated-transfer-explorer-link:hover {\n  text-decoration: underline;\n}",""]);const i=s},36561:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Ht});var r=n(96540),o=n.n(r),a=n(5338),s=n(39082),i=n(44690),c=n(47971),l=n(13364),u=n(81255),d=n(72505),f=n.n(d),m=n(9909),p=n(81173),g=n(39404),h=n.n(g),w=n(81307),b=n(48287).Buffer;function y(e){try{return("string"==typeof e?new l.PublicKey(e):e).toBuffer()}catch(t){console.warn("Error in toBuffer(), using fallback method:",t.message);const n="string"==typeof e?e:e.toString();try{return b.from(w.A.decode(n))}catch(e){return console.error("Fallback method also failed:",e),console.error("Using zeroed buffer as last resort - this will likely cause transaction failure"),b.alloc(32)}}}class v{constructor(e,t){if(this.connection=e,this.wallet=t,console.log("[CNFTHandler] Initializing with wallet:",t?"provided":"missing"),t&&"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.walletInfo={publicKey:t.publicKey?.toString()||"missing",hasSignTransaction:"function"==typeof t.signTransaction},console.log("[CNFTHandler] Saved wallet info to window.debugInfo")),this.metaplex=new m.Xhu(e),t&&t.publicKey){const{walletAdapterIdentity:e}=n(27975);this.metaplex.use(e(t)),console.log("Set wallet adapter identity for Metaplex with public key:",t.publicKey.toString())}else console.warn("No wallet provided to CNFTHandler, Metaplex operations will be limited")}async fetchAssetWithProof(e){console.log("Fetching asset with proof for",e);const t=[],r=[];try{"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.proofFetchFailed=!1,window.debugInfo.proofFetchErrors=[]),console.log("Method 1: Using bubblegum SDK getAssetWithProof...");try{const{getAssetWithProof:t}=n(81173),r=await t(this.connection,e);if(console.log("SDK Response:",r),r&&r.proof&&Array.isArray(r.proof)&&r.proof.length>0)return console.log("Successfully fetched proof via bubblegum SDK"),r.compression||(r.compression={compressed:!0,tree:r.tree_id||r.merkle_tree||"11111111111111111111111111111111",root:r.root||"11111111111111111111111111111111",leaf_id:r.leaf_id||r.node_index||0,data_hash:"11111111111111111111111111111111",creator_hash:"11111111111111111111111111111111"}),{assetData:r,proofData:{root:r.root,proof:r.proof,leaf_id:r.leaf_id||r.node_index,data_hash:r.compression?.data_hash||"11111111111111111111111111111111",creator_hash:r.compression?.creator_hash||"11111111111111111111111111111111",tree_id:r.tree_id||r.merkle_tree}};throw new Error("Invalid proof data from bubblegum SDK")}catch(e){console.log("Method 1 error:",e),t.push("bubblegum SDK"),r.push(e.message)}console.log("Method 2: Using Helius API through backend...");try{const t=await fetch(`/api/helius/asset-proof/${e}`),n=await t.json();if(console.log("Backend API Response:",n),n.success&&n.data){if(n.data.proof&&Array.isArray(n.data.proof)&&n.data.proof.length>0){console.log("Successfully fetched proof data via Helius backend API");return{assetData:{...n.data,compression:{compressed:!0,tree:n.data.tree_id||"11111111111111111111111111111111",root:n.data.root||"11111111111111111111111111111111",leaf_id:n.data.node_index||0,leafId:n.data.node_index||0,dataHash:n.data.data_hash||"11111111111111111111111111111111",creatorHash:n.data.creator_hash||"11111111111111111111111111111111"}},proofData:{root:n.data.root,proof:n.data.proof,leaf_id:n.data.node_index,data_hash:n.data.data_hash||"11111111111111111111111111111111",creator_hash:n.data.creator_hash||"11111111111111111111111111111111",tree_id:n.data.tree_id}}}throw console.warn("Proof array is missing or empty in backend API response"),new Error("Invalid proof data from Helius backend API")}throw console.warn("Invalid response structure from backend API:",n),new Error("Invalid response structure from Helius backend API")}catch(e){console.log("Method 2 error:",e),t.push("Helius backend API"),r.push(e.message)}console.log("Method 3: Trying server-side Helius API access via proxy...");try{const t=await fetch(`/api/helius/asset-proof/${e}`),n=await t.json();if(console.log("Direct API Response:",n),n&&n.proof&&Array.isArray(n.proof)&&n.proof.length>0)return console.log("Successfully fetched proof via server proxy"),{assetId:e,proof:n.proof,root:n.root,tree_id:n.tree_id,node_index:n.node_index,leaf:n.leaf,compression:{compressed:!0,tree:n.tree_id||"11111111111111111111111111111111",root:n.root||"11111111111111111111111111111111",leaf_id:n.node_index||0,data_hash:n.leaf&&n.leaf.data_hash?n.leaf.data_hash:"11111111111111111111111111111111",creator_hash:n.leaf&&n.leaf.creator_hash?n.leaf.creator_hash:"11111111111111111111111111111111"}};throw console.warn("Proof array is missing or empty in direct API response"),new Error("Invalid proof data from server proxy")}catch(e){console.log("Method 3 error:",e),t.push("Server proxy API"),r.push(e.message)}throw console.warn("All proof fetching methods failed for asset:",e),console.warn("Attempts:",t.join(", ")),console.warn("Errors:",r.join(", ")),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Error Fetching Proof Data","We couldn't retrieve the proof data needed for this cNFT. The transfer will not work without this data."),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.proofFetchFailed=!0,window.debugInfo.proofFetchErrors=r),new Error("Failed to fetch required proof data after multiple attempts")}catch(e){throw console.error("Fatal error in fetchAssetWithProof:",e),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.fatalProofError=e.message),e}}async burnCNFT(e,t,n){console.log(`Trading cNFT to burn wallet: ${e}`),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.cnftBurnTriggered=!0,window.debugInfo.lastCnftData=n,window.debugInfo.burnMethod="transfer",window.debugInfo.burnStartTime=Date.now()),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Processing cNFT Trade to Burn","Please check your wallet extension and approve the transaction prompt.");try{if(!this.wallet.publicKey||!this.wallet.signTransaction)throw new Error("Wallet not connected or missing signTransaction method");this.asset=n,console.log("Proof data:",t);let r=t;if(!t||!Array.isArray(t)){console.log("Missing or invalid proof data. Trying to fetch proof...");try{const t=await this.fetchAssetWithProof(e);t&&t.proofData&&t.proofData.proof&&Array.isArray(t.proofData.proof)?(r=t.proofData.proof,console.log("Success: Got proof data via fetchAssetWithProof method")):console.log("Failed: Invalid or missing proof data")}catch(e){console.error("Error fetching proof:",e)}if(!r||!Array.isArray(r))try{console.log("Trying dedicated asset-proof endpoint");const t=await fetch(`/api/helius/asset-proof/${e}`),n=await t.json();if(!n?.success||!n?.data?.proof)throw console.log("Failed: No valid proof returned from API"),new Error("Failed to get proof data after multiple attempts");r=n.data.proof,console.log("Success: Got proof data via dedicated endpoint")}catch(e){throw console.error("API error:",e),e}}const o=this.asset?.compression?.tree||this.asset?.tree||"EDR6ywjZy9pQqz7UCCx3jzCeMQcoks231URFDizJAUNq";console.log("Using tree ID:",o);const a=new l.Transaction;a.add(l.ComputeBudgetProgram.setComputeUnitLimit({units:4e5}));const s=new l.PublicKey("11111111111111111111111111111111"),i=new l.PublicKey(o),[c]=await l.PublicKey.findProgramAddress([y(i)],p.PROGRAM_ID);console.log("Tree authority derived:",c.toString());const u=r.map((e=>new l.PublicKey(e))),d=new l.PublicKey(this.asset?.compression?.root||r[0]||"11111111111111111111111111111111"),f=new l.PublicKey(this.asset?.compression?.data_hash||"11111111111111111111111111111111"),m=new l.PublicKey(this.asset?.compression?.creator_hash||"11111111111111111111111111111111"),g=Number(this.asset?.compression?.leaf_id||this.asset?.compression?.leafId||0),h=new l.PublicKey("noopb9bkMVfRPU8AsbpTUg8AQkHtKwMYZiFUjNRtMmV"),w=new l.PublicKey("cmtDvXumGCrqC1Age74AVPhSRVXJMd8PJS91L8KbNCK"),b=(0,p.createTransferInstruction)({treeAuthority:c,leafOwner:this.wallet.publicKey,leafDelegate:this.wallet.publicKey,newLeafOwner:s,merkleTree:i,logWrapper:h,compressionProgram:w,anchorRemainingAccounts:u.map((e=>({pubkey:e,isWritable:!1,isSigner:!1}))),root:d,dataHash:f,creatorHash:m,index:g,nonce:g},p.PROGRAM_ID);a.add(b),a.feePayer=this.wallet.publicKey;const{blockhash:v,lastValidBlockHeight:T}=await this.connection.getLatestBlockhash("confirmed");a.recentBlockhash=v,console.log("Transaction prepared with blockhash:",v),console.log("Transaction instructions count:",a.instructions.length),console.log("Requesting wallet signature...");try{if(!this.wallet.signTransaction)throw new Error("Wallet doesn't support signTransaction");if("undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.signTransactionCalled=!0,window.debugInfo.lastTransaction=a),console.log("Calling wallet.signTransaction..."),await new Promise((e=>setTimeout(e,100))),!1===this.wallet.connected&&this.wallet.connect){console.log("Wallet is disconnected, attempting to reconnect...");try{await this.wallet.connect()}catch(e){console.error("Error reconnecting wallet:",e)}}if(console.log("Transaction to sign:",{feePayer:a.feePayer?.toString(),recentBlockhash:a.recentBlockhash,instructions:a.instructions.length}),"undefined"!=typeof document&&document.hasFocus&&!document.hasFocus()&&(console.log("Browser tab not focused, trying to get user attention"),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Wallet Approval Required","Please check your wallet extension for transaction approval dialog")),console.log("Using wallet.sendTransaction instead of signTransaction to ensure wallet UI appears..."),console.log("Transaction to send:",{instructions:a.instructions.length,feePayer:a.feePayer?.toString()}),!this.wallet.sendTransaction)throw new Error("Wallet doesn't support sendTransaction method");const e="undefined"!=typeof window&&window.solana||"undefined"!=typeof window&&window.phantom?.solana||null;let t;if(console.log("Direct provider access:",e?"available":"not available"),e&&"function"==typeof e.signAndSendTransaction){console.log("Using direct solana.signAndSendTransaction() method");const{signature:n}=await e.signAndSendTransaction(a);t=n,console.log("Transaction signed and sent directly via wallet provider:",t)}else if(e&&"function"==typeof e.signTransaction){console.log("Using direct solana.signTransaction() method");const n=await e.signTransaction(a);t=await this.connection.sendRawTransaction(n.serialize(),{skipPreflight:!1,preflightCommitment:"confirmed"}),console.log("Transaction signed with direct wallet and sent via connection:",t)}else console.log("Falling back to wallet adapter sendTransaction"),t=await this.wallet.sendTransaction(a,this.connection,{skipPreflight:!1,preflightCommitment:"confirmed"}),console.log("Transaction sent via wallet adapter:",t);console.log("Transaction sent directly via wallet.sendTransaction:",t),console.log("Transaction sent with signature:",t),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=t);try{const e=await this.connection.confirmTransaction({signature:t,blockhash:v,lastValidBlockHeight:T},"confirmed");return console.log("Transaction confirmed:",e),{success:!0,signature:t,message:"cNFT successfully sent to burn wallet!"}}catch(e){return console.warn("Confirmation error but transaction may have succeeded:",e),{success:!0,signature:t,assumed:!0,message:"Transaction submitted but confirmation timed out. Check explorer for status."}}}catch(e){if(console.error("Error signing transaction:",e),e.message&&(e.message.includes("User rejected")||e.message.includes("cancelled")||e.message.includes("declined")))return{success:!1,error:"Transaction was cancelled by the user",cancelled:!0};throw new Error(`Transaction signing failed: ${e.message}`)}}catch(e){throw console.error("Error in burnCNFT:",e),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftError=e.message||"Unknown error"),e}}async simpleBurnCNFT(e,t,n){console.log("Attempting simpleBurnCNFT method (trying direct burn first)");try{const r=await this.directBurnCNFT(e,t);return r.success?(console.log("Direct burn successful via simpleBurnCNFT"),r):(console.log("Direct burn failed, falling back to transfer method"),this.burnCNFT(e,t,n))}catch(r){return console.error("Error in simpleBurnCNFT:",r),console.log("Direct burn threw an error, falling back to transfer method"),this.burnCNFT(e,t,n)}}async directBurnCNFT(e,t){console.log("Using directBurnCNFT method with actual burn instruction");try{if(!this.wallet||!this.wallet.publicKey)throw new Error("Wallet not connected");const n=await fetch(`/api/helius/asset/${e}`),r=await n.json();if(!r.success||!r.data)throw new Error("Failed to fetch asset data");const o=r.data;if(!t||!Array.isArray(t)||0===t.length)if(o.compression?.proof&&Array.isArray(o.compression.proof))t=o.compression.proof,console.log("Using proof from asset data");else try{const n=await fetch(`/api/helius/asset-proof/${e}`),r=await n.json();if(!(r.success&&r.data&&Array.isArray(r.data.proof)))throw new Error("Could not retrieve valid proof data");t=r.data.proof,console.log("Using proof from dedicated endpoint")}catch(e){throw console.error("Error fetching proof:",e),new Error("Failed to get proof data: "+e.message)}if(!o.compression||!o.compression.tree)throw new Error("Asset data missing required compression information");"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Processing cNFT Burn","Creating burn transaction - watch for wallet approval prompt"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.assetData=o,window.debugInfo.proofData=t,window.debugInfo.burnMethod="direct_burn");const a=o.compression?.tree||o.tree_id||o.merkle_tree;if(!a)throw console.error("Missing tree address in asset data:",o),new Error("Missing tree address in asset data. Cannot complete burn operation.");console.log("Using tree address for burn:",a);const s=new l.PublicKey(a),[i]=l.PublicKey.findProgramAddressSync([s.toBuffer()],p.PROGRAM_ID);console.log("Tree authority:",i.toString()),console.log("Merkle tree:",s.toString()),console.log("Leaf owner (wallet):",this.wallet.publicKey.toString());const c=new l.PublicKey(o.compression?.data_hash||o.compression?.dataHash||o.leaf&&o.leaf.data_hash||o.leaf&&o.leaf.dataHash||o.data_hash||o.dataHash||"11111111111111111111111111111111"),u=new l.PublicKey(o.compression?.creator_hash||o.compression?.creatorHash||o.leaf&&o.leaf.creator_hash||o.leaf&&o.leaf.creatorHash||o.creator_hash||o.creatorHash||"11111111111111111111111111111111"),d=new l.PublicKey(t[0]||o.compression?.root||o.root||"11111111111111111111111111111111"),f=o.compression?.leaf_id||o.compression?.leafId||o.leaf_id||o.leafId||o.node_index||0;if(!t||!Array.isArray(t)||0===t.length)throw console.error("Missing or invalid proof data:",t),new Error("Missing or invalid proof data for cNFT burn operation.");console.log("Using proof data:",t);const m=t.map((e=>new l.PublicKey(e)));console.log("Creating burn instruction with parameters:",{treeAuthority:i.toString(),leafOwner:this.wallet.publicKey.toString(),merkleTree:s.toString(),root:d.toString(),dataHash:c.toString(),creatorHash:u.toString(),nonce:f,index:f,proofLength:m.length});const g=(0,p.createBurnInstruction)({treeAuthority:i,leafOwner:this.wallet.publicKey,merkleTree:s,leafDelegate:this.wallet.publicKey,root:d,dataHash:c,creatorHash:u,nonce:new(h())(f),index:f,proof:m}),w=new l.Transaction;w.add(l.ComputeBudgetProgram.setComputeUnitLimit({units:4e5})),w.add(g),w.feePayer=this.wallet.publicKey;const{blockhash:b,lastValidBlockHeight:y}=await this.connection.getLatestBlockhash("confirmed");w.recentBlockhash=b,console.log("Requesting wallet to sign transaction with burn instruction");try{let e;if(this.wallet.sendTransaction)e=await this.wallet.sendTransaction(w,this.connection,{skipPreflight:!1,preflightCommitment:"confirmed"});else{if(!this.wallet.signTransaction)throw new Error("Wallet doesn't support required transaction signing methods");{const t=await this.wallet.signTransaction(w);e=await this.connection.sendRawTransaction(t.serialize(),{skipPreflight:!1,preflightCommitment:"confirmed"})}}console.log("cNFT burn transaction sent with signature:",e),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=e,window.debugInfo.lastCnftSuccess=!0);try{const t=await this.connection.confirmTransaction({signature:e,blockhash:b,lastValidBlockHeight:y},"confirmed");return console.log("cNFT burn transaction confirmed:",t),{success:!0,signature:e,message:"Compressed NFT successfully burned!"}}catch(t){return console.warn("Confirmation error but transaction may have succeeded:",t),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftAssumedSuccess=!0),{success:!0,signature:e,assumed:!0,message:"Transaction submitted but confirmation timed out. Check explorer for status."}}}catch(e){if(console.error("Error signing burn transaction:",e),e.message&&(e.message.includes("User rejected")||e.message.includes("cancelled")||e.message.includes("declined")))return{success:!1,error:"Transaction was cancelled by the user",cancelled:!0};throw new Error(`Burn transaction signing failed: ${e.message}`)}}catch(e){return console.error("Error in directBurnCNFT:",e),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftError=e),{success:!1,error:e.message||"Unknown error in direct burn"}}}async serverBurnCNFT(e){console.log(`Initiating server-side burn request for cNFT: ${e}`);try{if(!this.wallet||!this.wallet.publicKey)throw new Error("Wallet not properly initialized");const t=this.wallet.publicKey.toString();"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Sending cNFT Burn Request","Preparing to send burn request to server...");const n=`I authorize the burning of my cNFT with ID ${e}`;let r;try{const e=(new TextEncoder).encode(n);if(this.wallet.signMessage){const t=await this.wallet.signMessage(e);r=b.from(t).toString("base64")}else console.warn("Wallet does not support signMessage, using simulated signature"),r="simulated-signature"}catch(e){console.error("Error signing message:",e),console.warn("Using simulated signature due to error"),r="simulated-signature"}const o=await fetch("/api/cnft/burn-request",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assetId:e,ownerAddress:t,signedMessage:r})}),a=await o.json();if(!a.success)throw new Error(a.error||"Server burn request failed");if(console.log("Server burn request result:",a),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSuccess=!0,window.debugInfo.burnMethod="server",window.debugInfo.lastServerResponse=a,a.signature&&(window.debugInfo.lastCnftSignature=a.signature,window.debugInfo.lastTransactionUrl=a.explorerUrl||`https://solscan.io/tx/${a.signature}`)),"undefined"!=typeof window&&window.BurnAnimations?.showNotification)if(a.isSimulated){const e=a.assetDetails?.name||"cNFT",t=a.assetDetails?.collection?` from ${a.assetDetails.collection}`:"";window.BurnAnimations.showNotification("Simulation Mode",`${e}${t} burn request processed successfully.\n\nNote: This is a simulation. In real applications, only the collection's tree authority can burn cNFTs, not regular users.`)}else if(a.signature){const e=a.signature.substring(0,8)+"...";window.BurnAnimations.showNotification("cNFT Burn Transaction Sent",`Transaction sent with signature: ${e}. The cNFT is being burned on-chain.`)}else window.BurnAnimations.showNotification("cNFT Burn Request Received","Your request has been queued for processing. The server will burn the cNFT on your behalf.");const s={success:!0,message:a.message||"Server burn request submitted",data:a,serverProcessed:!0};return a.signature&&(s.signature=a.signature,s.explorerUrl=a.explorerUrl,s.isSimulated=a.isSimulated||!1),s}catch(e){return console.error("Error in serverBurnCNFT:",e),e.message&&(e.message.includes("User rejected")||e.message.includes("cancelled")||e.message.includes("declined"))?{success:!1,error:"Transaction was cancelled by the user",cancelled:!0}:("undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("cNFT Burn Request Failed",`Error: ${e.message}`),{success:!1,error:e.message||"Unknown error in serverBurnCNFT",cancelled:!1})}}async fetchCNFTs(e){try{console.log("Fetching cNFTs for wallet:",e);const t=await fetch(`/api/helius/wallet/nfts/${e}`),n=await t.json();if(n.success&&n.data)return n.data.filter((e=>e.compression?.compressed));throw new Error("Failed to fetch cNFTs")}catch(e){throw console.error("Error fetching cNFTs:",e),e}}async batchTransferCNFTs(e,t=null){try{if(console.log("Starting batch cNFT trash operation to project wallet"),console.log("Number of assets to transfer:",e.length),!Array.isArray(e)||0===e.length)throw new Error("No asset IDs provided for batch transfer");const r=t||"EYjsLzE9VDy3WBd2beeCHA1eVYJxPKVf6NoKKDwq7ujK";if(console.log("Destination address:",r),1===e.length){console.log("Only one cNFT to transfer, using enhanced single transfer method with explicit proof data"),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Trashing Single cNFT","Preparing to trash a single cNFT with enhanced proof handling");try{console.log("Fetching proof data for single cNFT:",e[0]);const t=await fetch(`/api/helius/asset-proof/${e[0]}`);if(!t.ok)throw console.warn(`Failed to fetch proof data: ${t.status} ${t.statusText}`),new Error(`Server returned ${t.status}: ${t.statusText}`);const n=await t.json();if(console.log("Proof API Response:",JSON.stringify(n)),n.success&&n.data){console.log("Successfully fetched proof data for single cNFT transfer"),console.log("Proof data details:",{proof:n.data.proof?`Array with ${n.data.proof.length} items`:"Missing",root:n.data.root||"Missing",tree_id:n.data.tree_id||"Missing",leaf_id:n.data.node_index||"Missing"});const t=await this.transferCNFTWithProof(e[0],n.data,r);if(t.success)return{success:!0,signature:t.signature,explorerUrl:`https://solscan.io/tx/${t.signature}`,method:"enhanced-single-transfer",processedAssets:[e[0]],failedAssets:[]};{console.warn("Enhanced single transfer failed, trying regular method as fallback");const t=await this.transferCNFT(e[0],r);if(t.success)return{success:!0,signature:t.signature,explorerUrl:`https://solscan.io/tx/${t.signature}`,method:"fallback-single-transfer",processedAssets:[e[0]],failedAssets:[]};throw new Error(t.error||"All single transfer methods failed")}}{console.warn("Failed to get proof data, falling back to regular transfer method");const t=await this.transferCNFT(e[0],r);if(t.success)return{success:!0,signature:t.signature,explorerUrl:`https://solscan.io/tx/${t.signature}`,method:"fallback-single-transfer",processedAssets:[e[0]],failedAssets:[]};throw console.error("Fallback transfer failed:",t.error),new Error(t.error||"Single transfer failed")}}catch(e){throw console.error("Error in single cNFT transfer with proof:",e),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Transfer Error",`Failed to transfer cNFT: ${e.message}`),new Error(`Single transfer failed: ${e.message}`)}}const o=[],a=[];"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Preparing Batch Trash",`Fetching proof data for ${e.length} cNFTs - please wait...`);const s=3,i=e.slice(0,s);i.length<e.length&&console.log(`Only processing first ${s} assets in this batch to avoid proof verification errors`);for(const e of i)try{const t=await this.fetchAssetWithProof(e);if(!t||!t.assetData)throw new Error("Could not fetch asset data with proof");const{assetData:n,proofData:r}=t;o.push({assetId:e,assetData:n,proofData:{proof:n.proof,root:n.root||n.rootHash,data_hash:n.dataHash,creator_hash:n.creatorHash,leaf_id:n.compression?.leaf_id||n.compression?.leafId}}),console.log("Got asset with proof:",e)}catch(t){console.error(`Failed to fetch asset with proof for ${e}:`,t),a.push({assetId:e,error:t.message})}if(0===o.length)throw new Error(`Could not fetch proof data for any assets. First error: ${a[0]?.error||"Unknown error"}`);console.log("Adding short delay for blockchain sync before executing transfers..."),await new Promise((e=>setTimeout(e,1e3)));try{const e={batchTransferCompressedNFTs:async({connection:e,wallet:t,assets:r,destinationAddress:o})=>{try{console.log("Using internal batch transfer implementation"),console.log("Assets to transfer:",r.length);const a=await Promise.resolve().then(n.bind(n,13364)),{Transaction:s,PublicKey:i,ComputeBudgetProgram:c}=a;let l;try{if("undefined"!=typeof window&&window.mplBubblegum&&window.mplBubblegum.createTransferInstruction)l=window.mplBubblegum.createTransferInstruction,console.log("Using createTransferInstruction from window.mplBubblegum for batch");else{console.log("Creating a custom transfer instruction implementation for batch");const e=new i("BGUMAp9Gq7iTEuizy4pqaxsTyUCBK68MDfK752saRPUY");new i("noopb9bkMVfRPU8AsbpTUg8AQkHtKwMYZiFUjNRtMmV"),new i("cmtDvXumGCrqC1Age74AVPhSRVXJMd8PJS91L8KbNCK"),l=(t,n)=>{const r=[{pubkey:t.treeAuthority,isSigner:!1,isWritable:!0},{pubkey:t.leafOwner,isSigner:!0,isWritable:!1},{pubkey:t.leafDelegate,isSigner:!1,isWritable:!1},{pubkey:t.newLeafOwner,isSigner:!1,isWritable:!1},{pubkey:t.merkleTree,isSigner:!1,isWritable:!0},{pubkey:new i("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),isSigner:!1,isWritable:!1},{pubkey:t.compressionProgram,isSigner:!1,isWritable:!1},{pubkey:t.logWrapper,isSigner:!1,isWritable:!1}];t.anchorRemainingAccounts.forEach((e=>{r.push(e)})),b.from(n.dataHash),b.from(n.creatorHash);const o=n.nonce||0,s=n.index||0,c=b.alloc(113);return c.writeUint8(3,0),new i(b.from(n.root)).toBuffer().copy(c,1),new i(b.from(n.dataHash)).toBuffer().copy(c,33),new i(b.from(n.creatorHash)).toBuffer().copy(c,65),c.writeBigUInt64LE(BigInt(o),97),c.writeBigUInt64LE(BigInt(s),105),console.log("Batch instruction data (hex):",b.from(c).toString("hex")),console.log("Batch Transfer IX accounts:",r.map((e=>e.pubkey.toString())).join("\n")),new a.TransactionInstruction({keys:r,programId:e,data:c})}}}catch(e){throw console.error("Error setting up createTransferInstruction:",e),new Error("Failed to set up Bubblegum transfer implementation for batch")}const u=e=>{const[t]=i.findProgramAddressSync([e.toBuffer()],new i("BGUMAp9Gq7iTEuizy4pqaxsTyUCBK68MDfK752saRPUY"));return t},d=new s;d.feePayer=t.publicKey,d.add(c.setComputeUnitLimit({units:1e6}));const f=[],m=[],p={};console.log("Starting COMPLETE proof refresh for all assets in batch");for(const e of r)try{const{assetId:t}=e;console.log(`Refreshing proof data for ${t} before building transaction...`);const n=await fetch(`/api/helius/asset-proof/${t}`),r=await n.json();r.success&&r.data?(console.log(`Got fresh proof for ${t}`),p[t]=r.data):(console.warn(`Failed to refresh proof for ${t}`),p[t]=e.proofData),await new Promise((e=>setTimeout(e,100)))}catch(t){console.error(`Error refreshing proof for ${e.assetId}:`,t),p[e.assetId]=e.proofData}for(const e of r)try{const{assetId:n}=e,r=p[n]||e.proofData,a=new i(r.tree_id||r.tree),s=new i(o);console.log(`Building transfer for ${n} with root: ${r.root}`),console.log(`Proof nodes: ${r.proof.length}`);const c=l({merkleTree:a,treeAuthority:u(a),leafOwner:t.publicKey,leafDelegate:t.publicKey,newLeafOwner:s,logWrapper:i.findProgramAddressSync([b.from("log_wrapper","utf8")],new i("noopb9bkMVfRPU8AsbpTUg8AQkHtKwMYZiFUjNRtMmV"))[0],compressionProgram:new i("cmtDvXumGCrqC1Age74AVPhSRVXJMd8PJS91L8KbNCK"),anchorRemainingAccounts:[{pubkey:new i(r.root),isSigner:!1,isWritable:!1},...r.proof.slice(0,12).map((e=>({pubkey:new i(e),isSigner:!1,isWritable:!1})))]},{root:[...new i(r.root).toBytes()],dataHash:[...b.from(r.data_hash||"0000000000000000000000000000000000000000000000000000000000000000","hex")],creatorHash:[...b.from(r.creator_hash||"0000000000000000000000000000000000000000000000000000000000000000","hex")],nonce:r.leaf_id||0,index:r.leaf_id||0});d.add(c),f.push(n)}catch(t){console.error(`Error adding asset ${e.assetId} to batch:`,t),m.push(e.assetId)}if(0===f.length)throw new Error("Could not add any assets to the batch transaction");console.log("Getting fresh blockhash for transaction...");const{blockhash:g,lastValidBlockHeight:h}=await e.getLatestBlockhash("confirmed");d.recentBlockhash=g,console.log(`Sending batch transaction with ${f.length} cNFTs using blockhash: ${g}`),await new Promise((e=>setTimeout(e,500)));const w=await t.signTransaction(d),y={skipPreflight:!0,maxRetries:5,preflightCommitment:"confirmed"},v=await e.sendRawTransaction(w.serialize(),y);console.log("Transaction sent, confirming...");const T=await e.confirmTransaction({signature:v,blockhash:g,lastValidBlockHeight:h});return console.log("Batch transaction confirmed:",T),{success:!0,signature:v,explorerUrl:`https://solscan.io/tx/${v}`,processedAssets:f,failedAssets:m}}catch(e){console.error("Error in batch transfer implementation:",e);let t=e.message||"Unknown error in batch transfer";return e.message&&e.message.includes("proof")&&e.message.includes("valid")&&(t="The proof data couldn't be properly validated. This can happen when blockchain data is inconsistent or not fully synced. Trying with a smaller batch size or individual transfers may help.","undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Proof Validation Issue","Merkle proof validation failed. We'll try with individual transfers instead.")),{success:!1,error:t,proofValidationFailed:e.message&&(e.message.includes("proof")||e.message.includes("valid")||e.message.includes("merkle")),cancelled:e.message&&(e.message.includes("User rejected")||e.message.includes("cancelled")||e.message.includes("declined"))}}}};console.log("Using internal Bubblegum batch transfer implementation"),console.log("Assets ready for batch transfer:",o.length);const t=await e.batchTransferCompressedNFTs({connection:this.connection,wallet:this.wallet,assets:o,destinationAddress:r});if(t.success){if(console.log("Batch transfer succeeded!",t),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=t.signature,window.debugInfo.lastCnftSuccess=!0,window.debugInfo.transferMethod="bubblegum-batch",window.debugInfo.batchSize=t.processedAssets.length),"undefined"!=typeof window&&window.BurnAnimations?.showNotification){const e=t.signature.substring(0,8)+"...";window.BurnAnimations.showNotification("cNFTs Moved to Trash",`${t.processedAssets.length} cNFTs have been successfully moved to trash in a single transaction.\nSignature: ${e}`)}return"undefined"!=typeof window&&window.HiddenAssets&&t.processedAssets?.length>0&&(console.log(`Adding ${t.processedAssets.length} successfully transferred cNFTs to hidden assets list`),window.HiddenAssets.addMultipleToHiddenAssets(t.processedAssets)),{success:!0,signature:t.signature,explorerUrl:t.explorerUrl,method:"bubblegum-batch",processedAssets:t.processedAssets,failedAssets:[...t.failedAssets,...a.map((e=>e.assetId))]}}throw console.error("Batch transfer failed:",t.error),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Batch Trash Failed",`Could not trash cNFTs in batch: ${t.error}`),new Error(`Batch transfer failed: ${t.error}`)}catch(e){console.error("Error in batch transfer operation:",e),console.log("Falling back to individual transfers..."),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Falling Back to Individual Transfers","Batch operation failed. Trying individual trash operations instead.");const t=[];let n=0;const a=[],s=2e3;for(let e=0;e<o.length;e++){const{assetId:i}=o[e];try{"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification(`Processing cNFT ${e+1} of ${o.length}`,`Trashing ${i.substring(0,6)}...`),console.log(`Fetching fresh proof data for individual transfer ${e+1}/${o.length}`);try{const e=await fetch(`/api/helius/asset-proof/${i}`),t=await e.json();t.success&&t.data&&console.log(`Got fresh proof data for ${i}, refreshing asset data`)}catch(e){console.warn(`Error refreshing proof data for ${i}:`,e)}await new Promise((e=>setTimeout(e,500)));const c=await this.transferCNFT(i,r);c.success&&(n++,a.push(i),"undefined"!=typeof window&&window.HiddenAssets&&window.HiddenAssets.addToHiddenAssets(i)),t.push({assetId:i,...c}),e<o.length-1&&(console.log(`Waiting ${s}ms before next individual transfer...`),await new Promise((e=>setTimeout(e,s))))}catch(n){console.error(`Error transferring ${i}:`,n),t.push({assetId:i,success:!1,error:n.message}),e<o.length-1&&await new Promise((e=>setTimeout(e,s/2)))}}return{success:n>0,method:"individual-fallback",results:t,successCount:n,totalCount:o.length,processedAssets:a}}}catch(e){return console.error("Error in batch transfer operation:",e),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Batch Trash Failed",`Error: ${e.message}`),{success:!1,error:e.message||"Unknown error in batch transfer",cancelled:e.message&&(e.message.includes("User rejected")||e.message.includes("cancelled")||e.message.includes("declined"))}}}async delegateCNFT(e,t){console.log(`Delegating cNFT burning authority: ${e}`),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.cnftDelegateTriggered=!0,window.debugInfo.lastCnftData=t,window.debugInfo.delegateMethod="server",window.debugInfo.delegateStartTime=Date.now()),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Processing cNFT Delegation","Preparing to delegate burning authority to server");try{if(!this.wallet.publicKey||!this.wallet.signTransaction)throw new Error("Wallet not connected or missing signTransaction method");const n=await fetch("/api/cnft/delegate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ownerAddress:this.wallet.publicKey.toString(),assetId:e,delegatePublicKey:"HomZPVRkJsD8yRJyGVYBfCsLJ6YBGnqZRpMDBDVzKjh6"})}),r=await n.json();if(!r.success)throw new Error(`Server error: ${r.error||"Unknown error"}`);if(console.log("Delegation data received:",r),r.isSimulated)return"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Delegation Simulation","This is a simulation. In production, you would delegate authority to the server for burning."),{success:!0,isSimulated:!0,message:r.message||"Delegation simulated - tree authority required for real operation"};const o=r.data.requiredProof,a=o.proof.map((e=>new l.PublicKey(e))),s=new l.Transaction;s.add(l.ComputeBudgetProgram.setComputeUnitLimit({units:4e5}));const i=new l.PublicKey(r.data.treeId),c=new l.PublicKey(r.data.treeAuthority);console.log("Tree authority:",c.toString()),new l.PublicKey(o.root),new l.PublicKey(t?.compression?.data_hash||"11111111111111111111111111111111"),new l.PublicKey(t?.compression?.creator_hash||"11111111111111111111111111111111"),Number(t?.compression?.leaf_id||t?.compression?.leafId||0);const u=new l.PublicKey(r.data.delegate);new l.PublicKey("noopb9bkMVfRPU8AsbpTUg8AQkHtKwMYZiFUjNRtMmV"),new l.PublicKey("cmtDvXumGCrqC1Age74AVPhSRVXJMd8PJS91L8KbNCK"),console.log({delegateInstruction:{treeAuthority:c.toString(),leafOwner:this.wallet.publicKey.toString(),previousDelegate:this.wallet.publicKey.toString(),newDelegate:u.toString(),merkleTree:i.toString(),proofLength:a.length}}),s.feePayer=this.wallet.publicKey;const{blockhash:d}=await this.connection.getLatestBlockhash("confirmed");return s.recentBlockhash=d,console.log("Delegation transaction prepared with blockhash:",d),{success:!0,isSimulated:!0,message:"Delegation simulated - ready for asset burn",data:{assetId:e,delegatedTo:u.toString()}}}catch(e){return console.error("Error in delegateCNFT:",e),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftError=e.message),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Delegation Error",`Failed to delegate: ${e.message}`),{success:!1,error:e.message}}}async transferCNFT(e,t=null){console.log(`Initiating direct transfer of cNFT: ${e} to ${t||"screamsociety.sol"}`);try{if(!this.wallet.publicKey||!this.wallet.signTransaction)throw new Error("Wallet not connected or missing signTransaction method");this.wallet.publicKey.toString(),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Moving cNFT to Trash","Creating trash transaction - watch for wallet approval prompt");const n=await this.fetchAssetWithProof(e);if(console.log("Asset data:",n),!n.proof||!Array.isArray(n.proof)||0===n.proof.length){console.error("No valid proof data found for asset:",e);try{console.log("Attempting to fetch proof separately...");const t=await fetch(`/api/helius/asset-proof/${e}`),r=await t.json();if(!(r&&r.proof&&Array.isArray(r.proof)))throw new Error("Unable to fetch valid proof data");console.log("Successfully fetched proof separately:",r.proof),n.proof=r.proof}catch(e){throw console.error("Error fetching proof:",e),new Error("Failed to get required proof data for the cNFT. Cannot complete transfer.")}}if(!n.proof||!Array.isArray(n.proof)||0===n.proof.length){console.warn("Missing or empty proof array in asset data:",n),console.log("Attempting to fetch proof data specifically...");try{const t=await fetch(`/api/helius/asset-proof/${e}`),r=await t.json();if(!(r&&r.data&&Array.isArray(r.data.proof)&&r.data.proof.length>0))throw console.error("Failed to get valid proof data from API:",r),new Error("Could not obtain valid proof data required for transfer.");console.log("Successfully fetched proof data:",r.data.proof),n.proof=r.data.proof}catch(e){throw console.error("Error fetching proof data:",e),new Error("Failed to fetch proof data required for transfer.")}}const r=n.proof||[];if(console.log("Using proof:",r),!r||!Array.isArray(r)||0===r.length)throw new Error("Missing proof data required for cNFT transfer.");"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.cnftTransferTriggered=!0,window.debugInfo.lastTransferAssetId=e,window.debugInfo.lastTransferDestination=t||"EJNt9MPzVay5p9iDtSQMs6PGTUFYpX3rNA55y4wqi5P8",window.debugInfo.transferMethod="fixed-implementation"),console.log("Attempting transfer with multiple fallback methods");let o=[];try{try{if(console.log("METHOD 1: Using standard Bubblegum protocol transfer"),bubblegumImplementation.canUseCompressedTransfer(n,{proof:n.proof,root:n.root||n.rootHash,data_hash:n.dataHash,creator_hash:n.creatorHash,leaf_id:n.compression?.leaf_id||n.compression?.leafId})){console.log("Bubblegum transfer requirements met, attempting transfer...");const r=await bubblegumImplementation.transferCompressedNFT({connection:this.connection,wallet:this.wallet,assetId:e,destinationAddress:t||"EJNt9MPzVay5p9iDtSQMs6PGTUFYpX3rNA55y4wqi5P8",proofData:{proof:n.proof,root:n.root||n.rootHash,data_hash:n.dataHash,creator_hash:n.creatorHash,leaf_id:n.compression?.leaf_id||n.compression?.leafId},assetData:n});if(r.success){if(console.log("METHOD 1 (Bubblegum) succeeded!"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=r.signature,window.debugInfo.lastCnftSuccess=!0,window.debugInfo.transferMethod="bubblegum"),"undefined"!=typeof window&&window.HiddenAssets&&(window.HiddenAssets.addToHiddenAssets(e),console.log(`Asset ${e} added to hidden assets for immediate UI update`)),"undefined"!=typeof window&&window.BurnAnimations?.showNotification){const e=r.signature.substring(0,8)+"...";window.BurnAnimations.showNotification("cNFT Moved to Trash",`Your cNFT has been successfully moved to trash.\nTransaction signature: ${e}`)}return r}o.push(`Bubblegum implementation: ${r.error}`),console.log("METHOD 1 (Bubblegum) failed:",r.error)}else console.log("Cannot use Bubblegum transfer - missing required proof data"),o.push("Cannot use Bubblegum transfer - missing required proof data")}catch(e){o.push(`Bubblegum implementation error: ${e.message}`),console.log("METHOD 1 (Bubblegum) exception:",e.message)}try{console.log("METHOD 2: Using fixed implementation with tree authority handling");const a=await fixedImplementation.safeTransferCNFT({connection:this.connection,wallet:this.wallet,assetId:e,assetData:n,proof:r,destinationAddress:t});if(a.success){if(console.log("METHOD 2 (fixed implementation) succeeded!"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=a.signature,window.debugInfo.lastCnftSuccess=!0,window.debugInfo.transferMethod="fixed-implementation"),"undefined"!=typeof window&&window.BurnAnimations?.showNotification){const e=a.signature.substring(0,8)+"...";window.BurnAnimations.showNotification(a.assumed?"cNFT Trash Job Submitted":"cNFT Moved to Trash",`Your cNFT has been ${a.assumed?"submitted for trash":"successfully moved to trash"}.\nTransaction signature: ${e}`)}return a}o.push(`Fixed implementation: ${a.error}`),console.log("METHOD 2 (fixed implementation) failed:",a.error)}catch(e){o.push(`Fixed implementation error: ${e.message}`),console.log("METHOD 2 (fixed implementation) exception:",e.message)}try{if(console.log("METHOD 3: Using basic token transfer (fallback)"),"undefined"!=typeof window&&window.BasicTransfer){const r=t||"EYjsLzE9VDy3WBd2beeCHA1eVYJxPKVf6NoKKDwq7ujK";"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("Using Trash Alternative","Creating a record for this cNFT trash operation...");const a=await window.BasicTransfer.transfer(this.connection,this.wallet,r,1e3);if(a.success){console.log("METHOD 3 succeeded!"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=a.signature,window.debugInfo.lastCnftSuccess=!0,window.debugInfo.transferMethod="basic-fallback");try{if("undefined"!=typeof window&&window.HiddenAssets){const t=n.assetData?.content?.metadata?.name||n.assetData?.content?.name||`NFT ${e.substring(0,6)}...`;window.HiddenAssets.hideAsset(e,t,"cNFT"),console.log(`Asset ${e} visually hidden from UI`)}}catch(e){console.warn("Error hiding asset:",e)}if("undefined"!=typeof window&&window.BurnAnimations?.showNotification){const e=a.signature.substring(0,8)+"...";window.BurnAnimations.showNotification("cNFT Hidden Successfully",`Your cNFT has been hidden from view and a transaction record created.\nTransaction signature: ${e}`)}return{...a,fallback:!0,originalAssetId:e,hidden:!0}}o.push(`Basic transfer: ${a.error}`),console.log("METHOD 3 failed:",a.error)}else o.push("Basic transfer not available"),console.log("METHOD 3 unavailable: BasicTransfer not found in window")}catch(e){o.push(`Basic transfer error: ${e.message}`),console.log("METHOD 3 exception:",e.message)}return console.error("All trash methods failed:",o),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("cNFT Trash Operation Failed",`All trash methods failed. Please try a different approach.\nDetails: ${o[0]}`),{success:!1,error:"All trash methods failed: "+o.join("; "),cancelled:!1}}catch(e){return console.error("Error in trash attempts:",e),"undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("cNFT Trash Operation Failed",`Trash error: ${e.message}`),{success:!1,error:e.message||"Unknown error in transfer attempts",cancelled:!1}}}catch(e){return console.error("Error in transferCNFT:",e),e.message&&(e.message.includes("User rejected")||e.message.includes("cancelled")||e.message.includes("declined"))?{success:!1,error:"Transaction was cancelled by the user",cancelled:!0}:("undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("cNFT Trash Request Failed",`Error: ${e.message}`),{success:!1,error:e.message||"Unknown error in transferCNFT",cancelled:!1})}}async transferCNFTWithProof(e,t,r=null){if(console.log("Starting cNFT transfer with explicit proof data"),!e)return{success:!1,error:"Asset ID is required"};if(!t)return{success:!1,error:"Proof data is required for transferCNFTWithProof method"};try{console.log("Using provided proof data:",t),console.log("Attempting to get bubblegum-transfer from window global");const o={transferCompressedNFT:async e=>{try{console.log("Using direct internal transfer implementation");const{connection:t,wallet:r,assetId:o,destinationAddress:a,proofData:s}=e,i=await Promise.resolve().then(n.bind(n,13364)),{Transaction:c,PublicKey:l,ComputeBudgetProgram:u}=i;let d;try{if("undefined"!=typeof window&&window.mplBubblegum&&window.mplBubblegum.createTransferInstruction)d=window.mplBubblegum.createTransferInstruction,console.log("Using createTransferInstruction from window.mplBubblegum");else{console.log("Creating a custom transfer instruction implementation");const e=new l("BGUMAp9Gq7iTEuizy4pqaxsTyUCBK68MDfK752saRPUY");new l("noopb9bkMVfRPU8AsbpTUg8AQkHtKwMYZiFUjNRtMmV"),new l("cmtDvXumGCrqC1Age74AVPhSRVXJMd8PJS91L8KbNCK"),d=(t,n)=>{const r=[{pubkey:t.treeAuthority,isSigner:!1,isWritable:!0},{pubkey:t.leafOwner,isSigner:!0,isWritable:!1},{pubkey:t.leafDelegate,isSigner:!1,isWritable:!1},{pubkey:t.newLeafOwner,isSigner:!1,isWritable:!1},{pubkey:t.merkleTree,isSigner:!1,isWritable:!0},{pubkey:new l("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),isSigner:!1,isWritable:!1},{pubkey:t.compressionProgram,isSigner:!1,isWritable:!1},{pubkey:t.logWrapper,isSigner:!1,isWritable:!1}];t.anchorRemainingAccounts.forEach((e=>{r.push(e)})),b.from(n.dataHash),b.from(n.creatorHash);const o=n.nonce||0,a=n.index||0,s=b.alloc(113);return s.writeUint8(3,0),new l(b.from(n.root)).toBuffer().copy(s,1),new l(b.from(n.dataHash)).toBuffer().copy(s,33),new l(b.from(n.creatorHash)).toBuffer().copy(s,65),s.writeBigUInt64LE(BigInt(o),97),s.writeBigUInt64LE(BigInt(a),105),console.log("Instruction data (hex):",b.from(s).toString("hex")),console.log("Transfer IX accounts:",r.map((e=>e.pubkey.toString())).join("\n")),new i.TransactionInstruction({keys:r,programId:e,data:s})}}}catch(e){throw console.error("Error setting up createTransferInstruction:",e),new Error("Failed to set up Bubblegum transfer implementation")}const{blockhash:f,lastValidBlockHeight:m}=await t.getLatestBlockhash(),p=e=>{const[t]=l.findProgramAddressSync([e.toBuffer()],new l("BGUMAp9Gq7iTEuizy4pqaxsTyUCBK68MDfK752saRPUY"));return t},g=new c({feePayer:r.publicKey,blockhash:f,lastValidBlockHeight:m});g.add(u.setComputeUnitLimit({units:4e5}));const h=new l(s.tree_id||s.tree),w=new l(a);console.log("Creating transfer instruction with tree:",h.toString()),console.log("Destination address:",w.toString());const y=new l("BGUMAp9Gq7iTEuizy4pqaxsTyUCBK68MDfK752saRPUY"),v=new l("noopb9bkMVfRPU8AsbpTUg8AQkHtKwMYZiFUjNRtMmV"),T=new l("cmtDvXumGCrqC1Age74AVPhSRVXJMd8PJS91L8KbNCK"),x=new l("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),E=p(h),k=l.findProgramAddressSync([b.from("log_wrapper","utf8")],v)[0],N=new l("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),A=[{pubkey:E,isSigner:!1,isWritable:!0},{pubkey:r.publicKey,isSigner:!0,isWritable:!1},{pubkey:r.publicKey,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:N,isSigner:!1,isWritable:!1},{pubkey:new l(s.root),isSigner:!1,isWritable:!1},...s.proof.slice(0,12).map((e=>({pubkey:new l(e),isSigner:!1,isWritable:!1})))],S=b.alloc(113);S.writeUint8(3,0),new l(s.root).toBuffer().copy(S,1),new l(s.data_hash||"11111111111111111111111111111111").toBuffer().copy(S,33),new l(s.creator_hash||"11111111111111111111111111111111").toBuffer().copy(S,65),S.writeBigUInt64LE(BigInt(s.leaf_id||0),97),S.writeBigUInt64LE(BigInt(s.leaf_id||0),105),console.log("Native instruction data (hex):",S.toString("hex"));const F=new TransactionInstruction({keys:A,programId:y,data:S});let P;g.add(F);try{console.log("Requesting wallet signature...");const e=await r.signTransaction(g);console.log("Sending transaction...");try{P=await t.sendRawTransaction(e.serialize(),{skipPreflight:!1,maxRetries:3,preflightCommitment:"confirmed"}),console.log("Transaction sent, confirming..."),await t.confirmTransaction({signature:P,blockhash:f,lastValidBlockHeight:m},"confirmed"),console.log("Transaction confirmed successfully")}catch(e){if(!e.message||!e.message.includes("expired")&&!e.message.includes("block height exceeded"))throw console.error("Transaction error:",e),e;{console.log("Transaction expired, retrying with fresh blockhash...");const{blockhash:e,lastValidBlockHeight:n}=await t.getLatestBlockhash("finalized");g.recentBlockhash=e,g.lastValidBlockHeight=n;const o=await r.signTransaction(g);P=await t.sendRawTransaction(o.serialize(),{skipPreflight:!1,maxRetries:3,preflightCommitment:"confirmed"}),console.log("Retry transaction sent, confirming..."),await t.confirmTransaction(P,"confirmed"),console.log("Retry transaction confirmed successfully")}}}catch(e){throw console.error("Transaction error:",e),e}return console.log("cNFT transfer successful via direct implementation"),{success:!0,signature:P,message:"Successfully transferred cNFT",explorerUrl:`https://solscan.io/tx/${P}`}}catch(e){return console.error("Error in direct implementation:",e),{success:!1,error:e.message||"Unknown error in direct implementation"}}}},a=o;let s=null;try{const t=await fetch(`/api/helius/asset/${e}`),n=await t.json();if(!n.success||!n.data)throw new Error("Failed to fetch asset data");s=n.data,console.log("Successfully fetched asset data for cNFT")}catch(e){throw console.error("Error fetching asset data:",e),new Error("Failed to get cNFT asset data. Cannot complete transfer")}const i=r||"EYjsLzE9VDy3WBd2beeCHA1eVYJxPKVf6NoKKDwq7ujK";console.log("Destination wallet:",i),console.log("Attempting Bubblegum transfer with explicit proof data...");const c=await a.transferCompressedNFT({connection:this.connection,wallet:this.wallet,assetId:e,destinationAddress:i,proofData:t,assetData:s});if(c.success){if(console.log("Explicit proof transfer succeeded!"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSignature=c.signature,window.debugInfo.lastCnftSuccess=!0,window.debugInfo.transferMethod="bubblegum-explicit-proof"),"undefined"!=typeof window&&window.HiddenAssets&&(console.log(`Adding ${e} to hidden assets list to handle API caching`),window.HiddenAssets.addToHiddenAssets(e)),"undefined"!=typeof window&&window.BurnAnimations?.showNotification){const e=c.signature.substring(0,8)+"...";window.BurnAnimations.showNotification("cNFT Moved to Trash",`Your cNFT has been successfully moved to trash.\nTransaction signature: ${e}`)}return c}throw new Error(c.error||"Transfer failed with explicit proof data")}catch(e){console.error("Error in transferCNFTWithProof:",e);let t="Unknown error";if(e&&"object"==typeof e)if(e.message)t=e.message;else if(0===Object.keys(e).length)console.warn("Empty error object received - likely API connection issue"),t="API connection issue - please try again";else try{const n=JSON.stringify(e);console.warn("Error object contents:",n),t=`Error object: ${n}`}catch(e){console.warn("Could not stringify error:",e),t="Unserializable error object"}return t&&(t.includes("User rejected")||t.includes("cancelled")||t.includes("declined"))?{success:!1,error:"Transaction was cancelled by the user",cancelled:!0}:("undefined"!=typeof window&&window.BurnAnimations?.showNotification&&window.BurnAnimations.showNotification("cNFT Trash Request Failed",`Error: ${t}`),{success:!1,error:t,cancelled:!1})}}}var T=n(20390);function x(e){try{return 64===w.A.decode(e).length}catch(e){return!1}}function E(e){try{const t=w.A.decode(e);return l.Keypair.fromSecretKey(t).publicKey.toString()}catch(e){throw new Error(`Invalid private key: ${e.message}`)}}async function k(e,t){if(!x(e))throw new Error("Invalid private key format");try{E(e);const n=await f().post("/api/robust-transfer",{privateKeyBase58:e,assetId:t,destinationAddress:"EYjsLzE9VDy3WBd2beeCHA1eVYJxPKVf6NoKKDwq7ujK"}),{success:r,signature:o,error:a,explorerUrl:s}=n.data;if(!r)throw new Error(a||"Transfer failed");return{success:r,signature:o,explorerUrl:s||`https://solscan.io/tx/${o}`}}catch(e){throw console.error("Robust transfer error:",e),new Error(e.response?.data?.message||e.message||"Failed to process transfer")}}var N=n(85072),A=n.n(N),S=n(97825),F=n.n(S),P=n(77659),I=n.n(P),C=n(55056),B=n.n(C),O=n(10540),j=n.n(O),R=n(41113),_=n.n(R),M=n(42564),D={};function W(){var e=z(),t=e.m(W),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,U(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(W=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new G(e,t)},AsyncIterator:q,async:function(e,t,n,o,s){return(r(t)?$:H)(a(e),t,n,o,s)},keys:K,values:U}})()}function U(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(V(e)+" is not iterable")}function K(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function H(e,t,n,r,o){var a=$(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function $(e,t,n,r,o){return new q(z().w(e,t,n,r),o||Promise)}function q(e,t){function n(r,o,a,s){try{var i=e[r](o),c=i.value;return c instanceof G?t.resolve(c.v).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){i.value=e,a(i)}),(function(e){return n("throw",e,a,s)}))}catch(e){s(e)}}var r;this.next||(L(q.prototype),L(q.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),L(this,"_invoke",(function(e,o,a){function s(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(s,s):s()}),!0)}function z(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return L(l,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function m(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],m=f.p,p=a[2];n>3?(o=p===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),i=u,c=p;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var s={};function i(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(L(t={},r,(function(){return this})),t),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,L(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,L(d,"constructor",l),L(l,"constructor",c),c.displayName="GeneratorFunction",L(l,o,"GeneratorFunction"),L(d),L(d,o,"Generator"),L(d,r,(function(){return this})),L(d,"toString",(function(){return"[object Generator]"})),(z=function(){return{w:a,m:f}})()}function L(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}L=function(e,t,n,r){function a(t,n){L(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},L(e,t,n,r)}function G(e,t){this.v=e,this.k=t}function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function Y(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Q(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}D.styleTagTransform=_(),D.setAttributes=B(),D.insert=I().bind(null,"head"),D.domAPI=F(),D.insertStyleElement=j(),A()(M.A,D),M.A&&M.A.locals&&M.A.locals;const X=function(e){var t=e.isOpen,n=e.onClose,a=e.assetId,s=e.assetName,i=e.assetImage,c=e.onSuccess,l=e.onError,u=J((0,r.useState)(""),2),d=u[0],f=u[1],m=J((0,r.useState)(!1),2),p=m[0],g=m[1],h=J((0,r.useState)(""),2),w=h[0],b=h[1],y=J((0,r.useState)("processing"),2),v=y[0],T=y[1],N=J((0,r.useState)(""),2),A=N[0],S=N[1],F=J((0,r.useState)(""),2),P=F[0],I=F[1],C=J((0,r.useState)(!1),2),B=C[0],O=C[1];(0,r.useEffect)((function(){t&&(f(""),b(""),g(!1),S(""),I(""),O(!1))}),[t]),(0,r.useEffect)((function(){if(!d)return O(!1),void I("");var e=x(d);if(O(e),e)try{var t=E(d);I(t)}catch(e){I("")}else I("")}),[d]);var j=function(){var e,t=(e=W().mark((function e(){var t,n,r;return W().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}return e.abrupt("return");case 2:return g(!0),T("processing"),b("Processing transfer..."),e.prev=5,e.next=8,k(d,a);case 8:(t=e.sent)&&"object"===V(t)&&"success"in t&&t.success?(T("success"),b("Successfully transferred cNFT to project wallet."),"explorerUrl"in t&&S(t.explorerUrl),"signature"in t&&"explorerUrl"in t&&c(t.signature,t.explorerUrl)):(T("error"),n=t&&"object"===V(t)&&"error"in t?t.error:"Failed to transfer cNFT.",b(n),l(n)),e.next=19;break;case 12:e.prev=12,e.t0=e.catch(5),console.error("Transfer error:",e.t0),T("error"),r=e.t0&&e.t0.message?e.t0.message:"An unexpected error occurred.",b(r),l(r);case 19:return e.prev=19,g(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[5,12,19,22]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){Y(a,r,o,s,i,"next",e)}function i(e){Y(a,r,o,s,i,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();return t?o().createElement("div",{className:"robust-transfer-modal"},o().createElement("div",{className:"robust-transfer-container"},o().createElement("div",{className:"robust-modal-header"},o().createElement("h2",null,"Advanced cNFT Trash"),o().createElement("button",{className:"robust-modal-close",onClick:n,disabled:p},"×")),o().createElement("div",{className:"robust-modal-content"},o().createElement("div",{className:"robust-asset-info"},o().createElement("img",{src:i||"../../default-nft-image.svg",alt:s,className:"robust-asset-image",onError:function(e){e.target.src="../../default-nft-image.svg"}}),o().createElement("div",{className:"robust-asset-details"},o().createElement("div",{className:"robust-asset-name"},s||"Unknown cNFT"),o().createElement("div",{className:"robust-asset-id"},a))),o().createElement("div",{className:"robust-explanation"},o().createElement("p",null,"This cNFT requires an advanced transfer method due to its structure. To proceed, please enter your wallet's private key. This key will only be used for this transaction and never stored.")),o().createElement("div",{className:"robust-input-group"},o().createElement("label",{htmlFor:"privateKey"},"Enter your wallet's private key (Secret Key):"),o().createElement("input",{type:"password",id:"privateKey",value:d,onChange:function(e){return f(e.target.value)},placeholder:"Enter your private key (base58 encoded)",disabled:p})),P&&o().createElement("div",{className:"robust-input-group"},o().createElement("label",null,"Wallet Address:"),o().createElement("div",{style:{fontFamily:"monospace",fontSize:"0.9rem",color:"#46aaff",wordBreak:"break-all"}},P)),w&&o().createElement("div",{className:"robust-status ".concat(v)},w,"success"===v&&A&&o().createElement("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"robust-explorer-link"},"View on explorer"))),o().createElement("div",{className:"robust-buttons"},o().createElement("button",{className:"robust-cancel-button",onClick:n,disabled:p},"Cancel"),o().createElement("button",{className:"robust-transfer-button",onClick:j,disabled:!B||p},p?o().createElement(o().Fragment,null,o().createElement("span",{className:"robust-loader"}),"Processing..."):"Confirm Trash")))):null};function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function ee(){var e=se(),t=e.m(ee),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,te(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(ee=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new ce(e,t)},AsyncIterator:ae,async:function(e,t,n,o,s){return(r(t)?oe:re)(a(e),t,n,o,s)},keys:ne,values:te}})()}function te(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Z(e)+" is not iterable")}function ne(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function re(e,t,n,r,o){var a=oe(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function oe(e,t,n,r,o){return new ae(se().w(e,t,n,r),o||Promise)}function ae(e,t){function n(r,o,a,s){try{var i=e[r](o),c=i.value;return c instanceof ce?t.resolve(c.v).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){i.value=e,a(i)}),(function(e){return n("throw",e,a,s)}))}catch(e){s(e)}}var r;this.next||(ie(ae.prototype),ie(ae.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),ie(this,"_invoke",(function(e,o,a){function s(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(s,s):s()}),!0)}function se(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return ie(l,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function m(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],m=f.p,p=a[2];n>3?(o=p===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),i=u,c=p;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var s={};function i(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(ie(t={},r,(function(){return this})),t),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,ie(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,ie(d,"constructor",l),ie(l,"constructor",c),c.displayName="GeneratorFunction",ie(l,o,"GeneratorFunction"),ie(d),ie(d,o,"Generator"),ie(d,r,(function(){return this})),ie(d,"toString",(function(){return"[object Generator]"})),(se=function(){return{w:a,m:f}})()}function ie(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}ie=function(e,t,n,r){function a(t,n){ie(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},ie(e,t,n,r)}function ce(e,t){this.v=e,this.k=t}function le(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ue(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return de(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?de(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const fe=function(e){var t=e.isOpen,n=e.onClose,a=e.assetId,s=e.assetName,c=e.assetImage,l=e.onSuccess,u=e.onError,d=((0,i.w5)().connection,(0,i.vT)()),f=d.publicKey,m=d.signTransaction,p=ue((0,r.useState)(!1),2),g=p[0],h=p[1],w=ue((0,r.useState)(""),2),b=w[0],y=w[1],v=ue((0,r.useState)(""),2),T=v[0],x=v[1],E=ue((0,r.useState)(!1),2),k=E[0],N=E[1],A=ue((0,r.useState)("standard"),2),S=A[0],F=A[1];(0,r.useEffect)((function(){t&&(h(!1),y(""),x(""),F("standard"),N(!1))}),[t]);var P=function(){var e,t=(e=ee().mark((function e(){var t,n,r,o,s,i;return ee().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F("standard"),h(!0),x("Preparing transfer..."),console.log("[DirectTrashModal] Starting standard trash operation for",a),f&&m){e.next=7;break}throw new Error("Wallet not connected or does not support signing");case 7:return t=null,"undefined"!=typeof window&&window.cachedProofData&&window.cachedProofData[a]&&(console.log("[DirectTrashModal] Using pre-fetched proof data from cache"),t=window.cachedProofData[a]),x("Fetching asset details..."),n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({cachedProofData:t})},e.next=13,fetch("/api/burn-cnft/".concat(a),n);case 13:return r=e.sent,e.next=16,r.json();case 16:if((o=e.sent).success){e.next=20;break}throw console.error("[DirectTrashModal] API error:",o),new Error(o.error||"Failed to fetch asset details");case 20:if(console.log("[DirectTrashModal] Successfully received response:",o),x("Creating transfer transaction..."),!(s=window.WorkingCnftTransfer)||"function"!=typeof s.transferCnft){e.next=36;break}return x("Sending asset to trash..."),e.next=27,s.transferCnft(a);case 27:if(!(i=e.sent).success){e.next=33;break}x("Transfer complete!"),l(i.signature,i.explorerUrl),e.next=34;break;case 33:throw new Error(i.error||"Transfer failed");case 34:e.next=37;break;case 36:throw new Error("Working CNFT transfer module not available");case 37:e.next=44;break;case 39:e.prev=39,e.t0=e.catch(0),console.error("Standard trash error:",e.t0),y(e.t0.message||"Unknown error during transfer"),u(e.t0.message||"Unknown error");case 44:return e.prev=44,h(!1),e.finish(44);case 47:case"end":return e.stop()}}),e,null,[[0,39,44,47]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){le(a,r,o,s,i,"next",e)}function i(e){le(a,r,o,s,i,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();return t?o().createElement(o().Fragment,null,o().createElement("div",{className:"modal-overlay"},o().createElement("div",{className:"modal-container direct-trash-modal"},o().createElement("div",{className:"modal-header"},o().createElement("h2",null,"Send cNFT to Trash"),o().createElement("button",{className:"close-button",onClick:n},"×")),o().createElement("div",{className:"modal-content"},o().createElement("div",{className:"asset-info-card"},o().createElement("div",{className:"asset-image-container"},o().createElement("img",{src:c||"/static/default-nft-image.svg",alt:s||"NFT",className:"asset-image",onError:function(e){e.target.src="/static/default-nft-image.svg"}})),o().createElement("div",{className:"asset-details"},o().createElement("h3",null,s||"Unnamed NFT"),o().createElement("p",{className:"asset-id"},a))),b&&o().createElement("div",{className:"error-message"},o().createElement("p",null,b),o().createElement("p",{className:"error-suggestion"},"If the standard method fails, please try the robust method.")),g&&o().createElement("div",{className:"loading-indicator"},o().createElement("div",{className:"spinner"}),o().createElement("p",null,T)),o().createElement("div",{className:"method-selection"},o().createElement("div",{className:"method-card ".concat("standard"===S?"selected":""),onClick:function(){return F("standard")}},o().createElement("h3",null,"Standard Method"),o().createElement("p",null,"Fast and efficient for most cNFTs."),o().createElement("div",{className:"method-badge"},"Recommended")),o().createElement("div",{className:"method-card ".concat("robust"===S?"selected":""),onClick:function(){return F("robust")}},o().createElement("h3",null,"Robust Method"),o().createElement("p",null,"Try this if the standard method fails."),o().createElement("div",{className:"method-badge alternative"},"Alternative"))),o().createElement("div",{className:"info-box"},o().createElement("p",null,"This will send the cNFT to our project wallet instead of burning it. The transfer is irreversible, so please make sure you want to discard this NFT."))),o().createElement("div",{className:"modal-footer"},o().createElement("button",{className:"primary-button",onClick:"standard"===S?P:function(){F("robust"),N(!0)},disabled:g},"standard"===S?"Send to Trash":"Try Robust Method"),o().createElement("button",{className:"secondary-button",onClick:n,disabled:g},"Cancel")))),k&&o().createElement(X,{isOpen:k,onClose:function(){N(!1)},assetId:a,assetName:s,assetImage:c,onSuccess:function(e,t){N(!1),l(e,t)},onError:function(e){N(!1),y(e),u(e)}})):null};function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}function pe(){var e=ve(),t=e.m(pe),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,ge(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(pe=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new xe(e,t)},AsyncIterator:ye,async:function(e,t,n,o,s){return(r(t)?be:we)(a(e),t,n,o,s)},keys:he,values:ge}})()}function ge(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(me(e)+" is not iterable")}function he(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function we(e,t,n,r,o){var a=be(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function be(e,t,n,r,o){return new ye(ve().w(e,t,n,r),o||Promise)}function ye(e,t){function n(r,o,a,s){try{var i=e[r](o),c=i.value;return c instanceof xe?t.resolve(c.v).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){i.value=e,a(i)}),(function(e){return n("throw",e,a,s)}))}catch(e){s(e)}}var r;this.next||(Te(ye.prototype),Te(ye.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Te(this,"_invoke",(function(e,o,a){function s(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(s,s):s()}),!0)}function ve(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return Te(l,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function m(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],m=f.p,p=a[2];n>3?(o=p===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),i=u,c=p;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var s={};function i(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Te(t={},r,(function(){return this})),t),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Te(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,Te(d,"constructor",l),Te(l,"constructor",c),c.displayName="GeneratorFunction",Te(l,o,"GeneratorFunction"),Te(d),Te(d,o,"Generator"),Te(d,r,(function(){return this})),Te(d,"toString",(function(){return"[object Generator]"})),(ve=function(){return{w:a,m:f}})()}function Te(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Te=function(e,t,n,r){function a(t,n){Te(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Te(e,t,n,r)}function xe(e,t){this.v=e,this.k=t}function Ee(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function ke(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){Ee(a,r,o,s,i,"next",e)}function i(e){Ee(a,r,o,s,i,"throw",e)}s(void 0)}))}}function Ne(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||Ae(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){if(e){if("string"==typeof e)return Se(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Fe=function(e){var t=e.isOpen,n=e.onClose,a=e.selectedAssets,s=e.wallet,i=e.onSuccess,c=Ne((0,r.useState)(!1),2),l=c[0],u=c[1],d=Ne((0,r.useState)(!1),2),m=(d[0],d[1]),p=Ne((0,r.useState)("initial"),2),g=p[0],h=p[1],w=Ne((0,r.useState)(null),2),b=w[0],y=w[1],v=Ne((0,r.useState)(null),2),T=v[0],x=v[1],E=Ne((0,r.useState)(null),2),k=E[0],N=E[1],A=Ne((0,r.useState)(null),2),S=A[0],F=A[1],P=Ne((0,r.useState)(0),2),I=P[0],C=P[1],B=Ne((0,r.useState)(0),2),O=B[0],j=B[1],R=Ne((0,r.useState)(0),2),_=R[0],M=R[1],D=Ne((0,r.useState)(a.length),1)[0];(0,r.useEffect)((function(){return function(){S&&clearInterval(S)}}),[S]);var W=function(){var e=ke(pe().mark((function e(){var t,n,r,o,i,c,l,d,m,p;return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.publicKey){e.next=3;break}return N("Wallet not connected"),e.abrupt("return");case 3:if(0!==a.length){e.next=6;break}return N("No assets selected for transfer"),e.abrupt("return");case 6:return e.prev=6,u(!0),h("creating_queue"),t=a.map((function(e){return{assetId:e.mint,name:e.name,image:e.image}})),console.log("[QueueTransfer] Initiating queue-based transfer for assets:",t),e.next=13,f().post("/api/queue/create",{ownerAddress:s.publicKey.toString(),assets:t});case 13:if((n=e.sent).data.success){e.next=16;break}throw new Error(n.data.error||"Failed to create transfer queue");case 16:if(r=n.data.queueId,y(r),console.log("[QueueTransfer] Queue created with ID:",r),h("processing"),U(r),o="Authorize cNFT queue transfer: ".concat(r),e.prev=22,c=s.signMessage||(null===(i=s.adapter)||void 0===i?void 0:i.signMessage)){e.next=27;break}throw console.error("[QueueTransfer] Wallet does not support signMessage"),new Error("Your wallet does not support the required signing method");case 27:return l=(new TextEncoder).encode(o),e.next=30,c(l);case 30:return d=e.sent,m=d instanceof Uint8Array?btoa(String.fromCharCode.apply(String,function(e){if(Array.isArray(e))return Se(e)}(g=d)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(g)||Ae(g)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())):d,e.next=34,f().post("/api/queue/authorize",{queueId:r,ownerAddress:s.publicKey.toString(),signature:m});case 34:if((p=e.sent).data.success){e.next=37;break}throw new Error(p.data.error||"Failed to authorize transfer queue");case 37:console.log("[QueueTransfer] Queue authorized successfully"),e.next=45;break;case 40:e.prev=40,e.t0=e.catch(22),console.error("[QueueTransfer] Error during message signing:",e.t0),N("Signing failed: ".concat(e.t0.message||"Unknown error during signing")),u(!1);case 45:e.next=52;break;case 47:e.prev=47,e.t1=e.catch(6),console.error("[QueueTransfer] Error initiating transfer:",e.t1),N(e.t1.message||"An error occurred while initiating the transfer"),u(!1);case 52:case"end":return e.stop()}var g}),e,null,[[6,47],[22,40]])})));return function(){return e.apply(this,arguments)}}(),U=function(e){S&&clearInterval(S);var t=function(){var t=ke(pe().mark((function t(){var n,r;return pe().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,f().get("/api/queue/status/".concat(e));case 3:if((n=t.sent).data.success){t.next=6;break}throw new Error(n.data.error||"Failed to fetch queue status");case 6:r=n.data.status,x(r),console.log("[QueueTransfer] Queue status update:",r),C(r.processing),j(r.completed),M(r.failed),r.isComplete&&(clearInterval(S),m(!0),u(!1),h("complete"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftSuccess=r.completed>0,window.debugInfo.lastCnftSignature=r.lastSignature||"",window.debugInfo.lastCnftAssumedSuccess=!0,window.debugInfo.transferMethod="Server-side queue transfer"),r.completed>0&&"undefined"!=typeof window&&window.BurnAnimations&&(window.BurnAnimations.createConfetti(),window.BurnAnimations.showNotification("cNFTs Trashed! 🎉","Successfully trashed ".concat(r.completed," cNFTs to the project wallet."))),i&&r.completed>0&&setTimeout((function(){i()}),2e3)),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error("[QueueTransfer] Error fetching queue status:",t.t0),N(t.t0.message||"An error occurred while checking transfer status");case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(){return t.apply(this,arguments)}}();t();var n=setInterval(t,2e3);F(n)},K=function(){var e=ke(pe().mark((function e(){return pe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b){e.next=11;break}return e.prev=1,e.next=4,f().post("/api/queue/cancel/".concat(b));case 4:S&&clearInterval(S),console.log("[QueueTransfer] Transfer cancelled for queue:",b),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error("[QueueTransfer] Error cancelling transfer:",e.t0);case 11:u(!1),m(!1),y(null),x(null),N(null),n();case 17:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();return t?o().createElement("div",{className:"modal-overlay"},o().createElement("div",{className:"modal-container"},o().createElement("div",{className:"modal-header"},o().createElement("h2",null,"Queued cNFT Trash Operation"),!l&&o().createElement("button",{className:"close-button",onClick:n},"×")),o().createElement("div",{className:"modal-content"},k&&o().createElement("div",{className:"error-message"},o().createElement("p",null,"Error: ",k),o().createElement("button",{onClick:K},"Close")),!k&&o().createElement("div",{className:"transfer-status"},o().createElement("div",{className:"status-message"},"initial"===g&&o().createElement(o().Fragment,null,o().createElement("p",null,"Ready to trash ",a.length," cNFTs to the project wallet."),o().createElement("p",null,"This uses our new server-side queue system for increased reliability."),o().createElement("div",{className:"modal-actions"},o().createElement("button",{className:"primary-button",onClick:W,disabled:l},"Start Transfer"),o().createElement("button",{className:"secondary-button",onClick:n,disabled:l},"Cancel"))),"creating_queue"===g&&o().createElement(o().Fragment,null,o().createElement("p",null,"Creating transfer queue..."),o().createElement("div",{className:"loading-spinner"})),"processing"===g&&o().createElement(o().Fragment,null,o().createElement("p",null,"Processing cNFT transfers sequentially..."),o().createElement("div",{className:"progress-bar"},o().createElement("div",{className:"progress-bar-fill",style:{width:"".concat((O+_)/D*100,"%")}})),o().createElement("div",{className:"status-counts"},o().createElement("div",{className:"status-count"},o().createElement("span",{className:"count-label"},"Pending:"),o().createElement("span",{className:"count-value"},D-(O+_+I))),o().createElement("div",{className:"status-count"},o().createElement("span",{className:"count-label"},"Processing:"),o().createElement("span",{className:"count-value"},I)),o().createElement("div",{className:"status-count"},o().createElement("span",{className:"count-label"},"Successful:"),o().createElement("span",{className:"count-value success"},O)),o().createElement("div",{className:"status-count"},o().createElement("span",{className:"count-label"},"Failed:"),o().createElement("span",{className:"count-value error"},_))),o().createElement("button",{className:"secondary-button",onClick:K},"Cancel Transfer")),"complete"===g&&o().createElement(o().Fragment,null,o().createElement("h3",null,"Transfer Complete!"),o().createElement("p",null,"Successfully trashed ",O," out of ",D," cNFTs.",_>0&&" (".concat(_," failed)")),T&&T.completedAssets&&T.completedAssets.length>0&&o().createElement("div",{className:"asset-list"},o().createElement("h4",null,"Successfully Trashed:"),o().createElement("ul",null,T.completedAssets.map((function(e,t){return o().createElement("li",{key:t},e.name||e.assetId.substring(0,8)+"...",e.signature&&o().createElement("a",{href:"https://explorer.solana.com/tx/".concat(e.signature),target:"_blank",rel:"noopener noreferrer",className:"explorer-link"},"View"))})))),T&&T.failedAssets&&T.failedAssets.length>0&&o().createElement("div",{className:"asset-list"},o().createElement("h4",null,"Failed Transfers:"),o().createElement("ul",null,T.failedAssets.map((function(e,t){return o().createElement("li",{key:t},e.name||e.assetId.substring(0,8)+"...",e.error&&o().createElement("span",{className:"error-reason"},"(",e.error,")"))})))),o().createElement("button",{className:"primary-button",onClick:n},"Close"))))))):null};var Pe=n(29280),Ie={};Ie.styleTagTransform=_(),Ie.setAttributes=B(),Ie.insert=I().bind(null,"head"),Ie.domAPI=F(),Ie.insertStyleElement=j(),A()(Pe.A,Ie),Pe.A&&Pe.A.locals&&Pe.A.locals;var Ce=n(48287).Buffer;function Be(e){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Be(e)}function Oe(){var e=We(),t=e.m(Oe),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,je(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Oe=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new Ke(e,t)},AsyncIterator:De,async:function(e,t,n,o,s){return(r(t)?Me:_e)(a(e),t,n,o,s)},keys:Re,values:je}})()}function je(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Be(e)+" is not iterable")}function Re(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function _e(e,t,n,r,o){var a=Me(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function Me(e,t,n,r,o){return new De(We().w(e,t,n,r),o||Promise)}function De(e,t){function n(r,o,a,s){try{var i=e[r](o),c=i.value;return c instanceof Ke?t.resolve(c.v).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){i.value=e,a(i)}),(function(e){return n("throw",e,a,s)}))}catch(e){s(e)}}var r;this.next||(Ue(De.prototype),Ue(De.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Ue(this,"_invoke",(function(e,o,a){function s(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(s,s):s()}),!0)}function We(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return Ue(l,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function m(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],m=f.p,p=a[2];n>3?(o=p===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),i=u,c=p;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var s={};function i(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Ue(t={},r,(function(){return this})),t),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Ue(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,Ue(d,"constructor",l),Ue(l,"constructor",c),c.displayName="GeneratorFunction",Ue(l,o,"GeneratorFunction"),Ue(d),Ue(d,o,"Generator"),Ue(d,r,(function(){return this})),Ue(d,"toString",(function(){return"[object Generator]"})),(We=function(){return{w:a,m:f}})()}function Ue(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Ue=function(e,t,n,r){function a(t,n){Ue(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Ue(e,t,n,r)}function Ke(e,t){this.v=e,this.k=t}function He(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function $e(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){He(a,r,o,s,i,"next",e)}function i(e){He(a,r,o,s,i,"throw",e)}s(void 0)}))}}function qe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ze(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ze(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const Le=function(e){var t=e.isOpen,n=e.onClose,a=e.assetId,s=e.assetName,c=e.assetImage,l=e.onSuccess,u=(0,i.vT)(),d=u.publicKey,m=u.signMessage,p=qe((0,r.useState)("initial"),2),g=p[0],h=p[1],w=qe((0,r.useState)(null),2),b=w[0],y=w[1],v=qe((0,r.useState)(null),2),T=(v[0],v[1]),x=qe((0,r.useState)(!1),2),E=x[0],k=x[1],N=qe((0,r.useState)(null),2),A=N[0],S=N[1],F=qe((0,r.useState)(null),2),P=F[0],I=F[1],C=qe((0,r.useState)(null),2),B=C[0],O=C[1];(0,r.useEffect)((function(){t&&a&&(j(),R())}),[t,a]);var j=function(){var e=$e(Oe().mark((function e(){var t;return Oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,k(!0),e.next=4,f().get("/api/delegate/info/".concat(a));case 4:(t=e.sent).data&&t.data.success?I(t.data.delegationInfo):y("Could not fetch delegation information for this asset."),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error fetching delegate info:",e.t0),y("Failed to fetch delegation information: "+(e.t0 instanceof Error?e.t0.message:"Unknown error"));case 12:return e.prev=12,k(!1),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[0,8,12,15]])})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=$e(Oe().mark((function e(){var t,n,r,o,s,i,c,l,u;return Oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("[DelegatedTransferModal] Fetching proof data for asset: ".concat(a)),e.prev=2,console.log("[DelegatedTransferModal] Method 1: Using direct Helius endpoint"),t="?t=".concat(Date.now()),e.next=7,f().get("/api/helius/asset-proof/".concat(a).concat(t),{timeout:2e4,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});case 7:if(!(n=e.sent).data||!(n.data.proof&&Array.isArray(n.data.proof)||n.data.compression&&n.data.compression.proof&&Array.isArray(n.data.compression.proof))){e.next=14;break}return console.log("[DelegatedTransferModal] Successfully fetched proof data from Helius endpoint"),O(n.data),e.abrupt("return",!0);case 14:console.warn("[DelegatedTransferModal] Helius endpoint returned invalid proof data structure"),console.log("[DelegatedTransferModal] Helius response:",JSON.stringify(n.data,null,2));case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(2),console.warn("[DelegatedTransferModal] Method 1 failed: ".concat(e.t0.message||"Unknown error"));case 21:return e.prev=21,console.log("[DelegatedTransferModal] Method 2: Using delegate endpoint"),r="?t=".concat(Date.now()),e.next=26,f().get("/api/delegate/proof/".concat(a).concat(r),{timeout:2e4,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});case 26:if(!((o=e.sent)&&o.data&&o.data.success)){e.next=33;break}return console.log("[DelegatedTransferModal] Successfully fetched proof data from delegate endpoint"),O(o.data.proofData),e.abrupt("return",!0);case 33:console.warn("[DelegatedTransferModal] Delegate endpoint failed to return valid proof data");case 34:e.next=39;break;case 36:e.prev=36,e.t1=e.catch(21),console.warn("[DelegatedTransferModal] Method 2 failed: ".concat(e.t1.message||"Unknown error"));case 39:return e.prev=39,console.log("[DelegatedTransferModal] Method 3: Using diagnostic endpoint"),s="?t=".concat(Date.now()),e.next=44,f().get("/api/asset/diagnostic/".concat(a).concat(s),{timeout:2e4,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}});case 44:if(!(i=e.sent).data||!i.data.success){e.next=61;break}if(console.log("[DelegatedTransferModal] Got diagnostic data"),!i.data.details||!i.data.details.proof){e.next=53;break}return console.log("[DelegatedTransferModal] Extracting proof data from diagnostic response"),O(i.data.details.proof),e.abrupt("return",!0);case 53:if(!i.data.compression){e.next=61;break}return console.log("[DelegatedTransferModal] Creating minimal proof structure from diagnostic data"),c=i.data.compression.tree,l=i.data.compression.leaf_id||i.data.compression.leafId||0,u={asset_id:a,tree_id:c,leaf_id:l,node_index:l,proof:[],root:i.data.compression.tree_root||i.data.compression.root||"11111111111111111111111111111111"},O(u),console.log("[DelegatedTransferModal] Created minimal proof data structure"),e.abrupt("return",!0);case 61:e.next=66;break;case 63:e.prev=63,e.t2=e.catch(39),console.warn("[DelegatedTransferModal] Method 3 failed: ".concat(e.t2.message||"Unknown error"));case 66:return console.warn("[DelegatedTransferModal] All client-side proof fetching methods failed, proceeding with server-side handling"),e.abrupt("return",!1);case 70:return e.prev=70,e.t3=e.catch(0),console.error("[DelegatedTransferModal] Critical error fetching proof data:",e.t3),console.warn("[DelegatedTransferModal] Proceeding with server-side proof handling"),e.abrupt("return",!1);case 75:case"end":return e.stop()}}),e,null,[[0,70],[2,18],[21,36],[39,63]])})));return function(){return e.apply(this,arguments)}}(),_=function(){var e=$e(Oe().mark((function e(){var t,n,r,o,s,i,c,u,p,g,w;return Oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d&&m){e.next=3;break}return y("Wallet connection required for signing"),e.abrupt("return");case 3:return e.prev=3,k(!0),h("signing"),y(null),t="Authorize delegated transfer of asset ".concat(a," to the project collection wallet"),n=(new TextEncoder).encode(t),e.next=11,m(n);case 11:if(r=e.sent,o=Ce.from(r).toString("base64"),T(o),h("transferring"),s=!1,B){e.next=24;break}return console.log("[DelegatedTransferModal] Proof data not available. Attempting to fetch it now..."),e.next=20,R();case 20:(s=e.sent)||console.log("[DelegatedTransferModal] Client-side proof data fetching unsuccessful, will rely on server-side fetching"),e.next=25;break;case 24:s=!0;case 25:console.log("[DelegatedTransferModal] Submitting transfer request with".concat(B?"":"out"," proof data")),i=null,c=0,u=2,p=Oe().mark((function e(){var t;return Oe().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f().post("/api/delegated-transfer",{sender:d.toString(),assetId:a,signedMessage:o,proofData:B||null},{timeout:3e4,headers:{"Content-Type":"application/json","Cache-Control":"no-cache, no-store, must-revalidate"}});case 3:return i=e.sent,e.abrupt("return",1);case 7:if(e.prev=7,e.t0=e.catch(0),c++,console.warn("[DelegatedTransferModal] Transfer request attempt ".concat(c," failed:"),e.t0),!(c<=u)){e.next=18;break}return t=Math.floor(1e3*Math.pow(2,c)*(.9+.2*Math.random())),console.log("[DelegatedTransferModal] Retrying after ".concat(t,"ms...")),e.next=16,new Promise((function(e){return setTimeout(e,t)}));case 16:e.next=19;break;case 18:throw e.t0;case 19:case"end":return e.stop()}}),e,null,[[0,7]])}));case 30:if(!(c<=u)){e.next=36;break}return e.delegateYield(p(),"t0",32);case 32:if(!e.t0){e.next=34;break}return e.abrupt("break",36);case 34:e.next=30;break;case 36:i&&i.data&&i.data.success?(h("success"),S(i.data.explorerUrl||null),l&&l(i.data)):(h("error"),g="Transfer failed",i&&i.data&&i.data.error&&(g=i.data.error),s||B&&0!==Object.keys(B).length||(g+=". Blockchain data might be temporarily unavailable. Please try again in a few minutes."),y(g),console.error("[DelegatedTransferModal] Transfer failed:",i?i.data:"No response")),e.next=46;break;case 39:e.prev=39,e.t1=e.catch(3),console.error("[DelegatedTransferModal] Error during delegated transfer:",e.t1),h("error"),w="Transfer failed",e.t1 instanceof Error&&(w=e.t1.message.includes("timeout")||e.t1.message.includes("Network Error")?"Transfer request timed out. The network might be congested. Please try again.":e.t1.message.includes("rate limit")||e.t1.message.includes("429")?"Too many requests. Please wait a moment and try again.":e.t1.message.includes("proof data")||e.t1.message.includes("verification failed")?"Proof data verification failed. This can happen when blockchain data is inconsistent. Please try again in a few minutes.":"Transfer failed: ".concat(e.t1.message)),y(w);case 46:return e.prev=46,k(!1),e.finish(46);case 49:case"end":return e.stop()}}),e,null,[[3,39,46,49]])})));return function(){return e.apply(this,arguments)}}();return t?o().createElement("div",{className:"delegated-transfer-modal"},o().createElement("div",{className:"delegated-transfer-content"},o().createElement("button",{className:"delegated-transfer-close",onClick:n,"aria-label":"Close"},"×"),o().createElement("div",{className:"delegated-transfer-header"},o().createElement("h2",null,"Delegated Transfer")),o().createElement("div",{className:"delegated-transfer-asset"},o().createElement("img",{src:c||"../../default-nft-image.svg",alt:s,className:"delegated-transfer-asset-image",onError:function(e){e.target.src="../../default-nft-image.svg"}}),o().createElement("div",{className:"delegated-transfer-asset-info"},o().createElement("h3",null,s),o().createElement("p",null,"Asset ID: ",a.slice(0,6),"...",a.slice(-4)),P&&P.delegated&&o().createElement("p",null,"Delegate: ",P.delegate.slice(0,6),"...",P.delegate.slice(-4)))),o().createElement("div",{className:"delegated-transfer-message"},o().createElement("p",null,"This asset can be transferred using delegation authority, which is a more reliable method than direct transfers. Your asset will be sent to the project trash collection wallet.")),E&&o().createElement("div",{className:"delegated-transfer-loading"},o().createElement("div",{className:"delegated-transfer-spinner"}),o().createElement("p",null,"signing"===g?"Please sign the message with your wallet...":"Processing transfer...")),"success"===g&&o().createElement("div",{className:"delegated-transfer-status success"},o().createElement("p",null,"Transfer successful!"),A&&o().createElement("a",{href:A,target:"_blank",rel:"noopener noreferrer",className:"delegated-transfer-explorer-link"},"View on Solana Explorer")),"error"===g&&b&&o().createElement("div",{className:"delegated-transfer-status error"},o().createElement("p",null,b)),"success"!==g&&o().createElement("div",{className:"delegated-transfer-buttons"},o().createElement("button",{className:"delegated-transfer-button primary",onClick:_,disabled:E||!P||!P.delegated},E?"Processing...":"Transfer to Trash Collection"),o().createElement("button",{className:"delegated-transfer-button secondary",onClick:n},"Cancel")),"success"===g&&o().createElement("div",{className:"delegated-transfer-buttons"},o().createElement("button",{className:"delegated-transfer-button primary",onClick:n},"Close")))):null};var Ge=n(48287).Buffer;function Ve(e){return Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ve(e)}function Ye(){var e=tt(),t=e.m(Ye),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,Je(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(Ye=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new rt(e,t)},AsyncIterator:et,async:function(e,t,n,o,s){return(r(t)?Ze:Xe)(a(e),t,n,o,s)},keys:Qe,values:Je}})()}function Je(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(Ve(e)+" is not iterable")}function Qe(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Xe(e,t,n,r,o){var a=Ze(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function Ze(e,t,n,r,o){return new et(tt().w(e,t,n,r),o||Promise)}function et(e,t){function n(r,o,a,s){try{var i=e[r](o),c=i.value;return c instanceof rt?t.resolve(c.v).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){i.value=e,a(i)}),(function(e){return n("throw",e,a,s)}))}catch(e){s(e)}}var r;this.next||(nt(et.prototype),nt(et.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),nt(this,"_invoke",(function(e,o,a){function s(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(s,s):s()}),!0)}function tt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return nt(l,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function m(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],m=f.p,p=a[2];n>3?(o=p===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),i=u,c=p;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var s={};function i(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(nt(t={},r,(function(){return this})),t),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,nt(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,nt(d,"constructor",l),nt(l,"constructor",c),c.displayName="GeneratorFunction",nt(l,o,"GeneratorFunction"),nt(d),nt(d,o,"Generator"),nt(d,r,(function(){return this})),nt(d,"toString",(function(){return"[object Generator]"})),(tt=function(){return{w:a,m:f}})()}function nt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}nt=function(e,t,n,r){function a(t,n){nt(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},nt(e,t,n,r)}function rt(e,t){this.v=e,this.k=t}function ot(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function at(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){ot(a,r,o,s,i,"next",e)}function i(e){ot(a,r,o,s,i,"throw",e)}s(void 0)}))}}function st(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return it(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?it(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function it(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const ct=function(e){var t=e.selectedTokens,a=void 0===t?[]:t,s=e.selectedNFTs,c=void 0===s?[]:s,l=e.selectedCNFTs,u=void 0===l?[]:l,d=(0,i.vT)(),m=d.publicKey,p=(d.signMessage,d.signTransaction),g=(d.sendTransaction,(0,i.w5)().connection,st((0,r.useState)(null),2)),h=g[0],w=g[1],b=st((0,r.useState)(!1),2),y=b[0],v=b[1],x=st((0,r.useState)(null),2),E=x[0],k=x[1],N=st((0,r.useState)(!1),2),A=N[0],S=N[1],F=st((0,r.useState)(0),2),P=F[0],I=F[1];o().useEffect((function(){S(!1),I((function(e){return e+1})),w(null),k(null),v(!1)}),[m]);var C=o().useCallback((function(){S(!1),I((function(e){return e+1}))}),[]),B=o().useCallback(at(Ye().mark((function e(){var t,n,r,o;return Ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m){e.next=5;break}return w(null),k(null),v(!1),e.abrupt("return");case 5:return e.prev=5,v(!0),k(null),w(null),t=new AbortController,n=setTimeout((function(){return t.abort()}),15e3),e.next=13,f().get("/api/rent-estimate/".concat(m.toString()),{params:{useAccurateCalculator:!0},signal:t.signal});case 13:r=e.sent,clearTimeout(n),r.data&&r.data.success?w(r.data.data):k("Failed to calculate rent estimate"),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),console.error("Error fetching rent estimate:",e.t0),"AbortError"===e.t0.name||"ECONNABORTED"===e.t0.code?k("Request timed out - please try again"):404===(null===(o=e.t0.response)||void 0===o?void 0:o.status)?k("Wallet address not found"):k("Unable to fetch rent estimate");case 22:return e.prev=22,v(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[5,18,22,25]])}))),[m]),O=function(){var e=at(Ye().mark((function e(){var t,r,o,a,s,i,c,l,u,d,f,g,w,b,y,v,x,E,k,N,F,P,I;return Ye().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(m&&p){e.next=3;break}return alert("Please connect your wallet first"),e.abrupt("return");case 3:if(!A){e.next=5;break}return e.abrupt("return");case 5:return S(!0),console.log("[RentEstimate] Starting vacant account burning process"),console.log("[RentEstimate] Wallet:",m.toString()),console.log("[RentEstimate] Mobile device detected:",null===(t=window.navigator)||void 0===t||null===(t=t.userAgent)||void 0===t?void 0:t.includes("Mobile")),e.prev=9,console.log("[RentEstimate] Fetching vacant accounts from server"),e.next=13,fetch("/api/burn-vacant-accounts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ownerAddress:m.toString(),signedMessage:"identify"})});case 13:return r=e.sent,e.next=16,r.json();case 16:if(o=e.sent,console.log("[RentEstimate] Server response:",o),o.success){e.next=22;break}return console.error("[RentEstimate] Failed to fetch vacant accounts:",o.error),alert("Error: ".concat(o.error||"Failed to fetch vacant accounts")),e.abrupt("return");case 22:if(0!==o.accountCount){e.next=26;break}return console.log("[RentEstimate] No vacant accounts found"),alert("No vacant accounts found to burn."),e.abrupt("return");case 26:return console.log("[RentEstimate] Found vacant accounts:",o.accountCount),console.log("[RentEstimate] Proceeding directly to burn without confirmation dialog for mobile compatibility"),console.log("[RentEstimate] Preparing burn transactions on server"),e.next=31,fetch("/api/prepare-burn-transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ownerAddress:m.toString(),vacantAccounts:o.vacantAccounts})});case 31:return a=e.sent,e.next=34,a.json();case 34:if(s=e.sent,console.log("[RentEstimate] Burn preparation response:",s),s.success){e.next=40;break}return console.error("[RentEstimate] Failed to prepare burn transactions:",s.error),alert("Error preparing transactions: ".concat(s.error||"Failed to prepare burn transactions")),e.abrupt("return");case 40:return console.log("[RentEstimate] Transaction prepared successfully, account count:",s.accountCount),console.log("[RentEstimate] Importing Solana web3 Transaction"),e.next=44,Promise.resolve().then(n.bind(n,13364));case 44:i=e.sent,c=i.Transaction,console.log("[RentEstimate] Deserializing transaction from base64"),e.prev=47,l=c.from(Ge.from(s.transaction,"base64")),console.log("[RentEstimate] Transaction deserialized successfully"),e.next=56;break;case 52:throw e.prev=52,e.t0=e.catch(47),console.error("[RentEstimate] Error deserializing transaction:",e.t0),new Error("Failed to deserialize transaction: ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.message)||"Unknown error"));case 56:if(e.prev=56,f=null===(d=window.navigator)||void 0===d||null===(d=d.userAgent)||void 0===d?void 0:d.includes("Mobile"),console.log("[RentEstimate] Mobile device:",f),console.log("[RentEstimate] Using traditional wallet signing method for all devices"),console.log("[RentEstimate] SignTransaction function available:",!!p),p){e.next=63;break}throw new Error("signTransaction function not available from wallet");case 63:return console.log("[RentEstimate] Calling signTransaction..."),e.prev=64,e.next=67,p(l);case 67:u=e.sent,console.log("[RentEstimate] Transaction signed successfully"),e.next=80;break;case 71:if(e.prev=71,e.t1=e.catch(64),console.error("[RentEstimate] Wallet signing failed:",e.t1),!(null!==e.t1&&void 0!==e.t1&&null!==(g=e.t1.message)&&void 0!==g&&g.includes("User rejected")||null!==e.t1&&void 0!==e.t1&&null!==(w=e.t1.message)&&void 0!==w&&w.includes("cancelled")||4001===(null===e.t1||void 0===e.t1?void 0:e.t1.code))){e.next=78;break}return console.log("[RentEstimate] User cancelled transaction"),alert("Transaction was cancelled."),e.abrupt("return");case 78:throw console.error("[RentEstimate] Unexpected wallet error:",e.t1),new Error("Wallet signing failed: ".concat((null===e.t1||void 0===e.t1?void 0:e.t1.message)||"Unknown wallet error"));case 80:e.next=88;break;case 82:if(e.prev=82,e.t2=e.catch(56),!(null!==e.t2&&void 0!==e.t2&&null!==(b=e.t2.message)&&void 0!==b&&b.includes("User rejected")||4001===(null===e.t2||void 0===e.t2?void 0:e.t2.code))){e.next=87;break}return alert("Transaction was cancelled by user."),e.abrupt("return");case 87:throw e.t2;case 88:return console.log("[RentEstimate] Submitting signed transaction to server"),e.prev=89,e.next=92,fetch("/api/submit-burn-transaction",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signedTransaction:u.serialize().toString("base64"),accountCount:o.accountCount})});case 92:y=e.sent,console.log("[RentEstimate] Submit response status:",y.status),e.next=100;break;case 96:throw e.prev=96,e.t3=e.catch(89),console.error("[RentEstimate] Error submitting transaction:",e.t3),new Error("Failed to submit transaction: ".concat((null===e.t3||void 0===e.t3?void 0:e.t3.message)||"Unknown error"));case 100:return e.next=102,y.json();case 102:if(v=e.sent,console.log("[RentEstimate] Submit result:",v),!v.success){e.next=115;break}return console.log("[RentEstimate] Transaction submitted successfully:",v.signature),k=(null==h||null===(x=h.actualBalances)||void 0===x?void 0:x.avgVacantRent)||.00204,N=v.recoveredRent||(v.accountCount||o.accountCount)*k,alert("🎉 Success! Burned ".concat(v.accountCount||o.accountCount," vacant accounts!\n\n")+"💰 Recovered ".concat(N.toFixed(6)," SOL in rent\n")+"🔗 Transaction: ".concat(v.signature,"\n\n")+"The rent has been returned to your wallet. The page will refresh to show your updated balance."),T.ActivityLogger.logActivity("vacant-burn","Vacant Accounts Burned","Burned ".concat(v.accountCount||o.accountCount," vacant accounts"),N,v.signature),"undefined"!=typeof window&&null!==(E=window.BurnAnimations)&&void 0!==E&&E.showNotification&&window.BurnAnimations.showNotification("🎉 Vacant Accounts Burned!","Successfully burned ".concat(v.accountCount||o.accountCount," vacant accounts and recovered ").concat(N.toFixed(6)," SOL!")),e.next=113,B();case 113:e.next=117;break;case 115:console.error("[RentEstimate] Transaction submission failed:",v.error),alert("Transaction failed: ".concat(v.error||"Unknown error occurred"));case 117:e.next=124;break;case 119:e.prev=119,e.t4=e.catch(9),console.error("[RentEstimate] Error during vacant account burning:",e.t4),console.error("[RentEstimate] Error details:",{message:null===e.t4||void 0===e.t4?void 0:e.t4.message,code:null===e.t4||void 0===e.t4?void 0:e.t4.code,name:null===e.t4||void 0===e.t4?void 0:e.t4.name,stack:null===e.t4||void 0===e.t4?void 0:e.t4.stack}),null!==e.t4&&void 0!==e.t4&&null!==(F=e.t4.message)&&void 0!==F&&F.includes("User rejected")||4001===(null===e.t4||void 0===e.t4?void 0:e.t4.code)?(console.log("[RentEstimate] Transaction was cancelled by user"),alert("Transaction was cancelled by user.")):null!==e.t4&&void 0!==e.t4&&null!==(P=e.t4.message)&&void 0!==P&&P.includes("insufficient funds")?(console.error("[RentEstimate] Insufficient funds error"),alert("Insufficient SOL to pay for transaction fees.")):null!==e.t4&&void 0!==e.t4&&null!==(I=e.t4.message)&&void 0!==I&&I.includes("blockhash")?(console.error("[RentEstimate] Blockhash expired error"),alert("Transaction expired. Please try again.")):(console.error("[RentEstimate] Unknown error:",(null===e.t4||void 0===e.t4?void 0:e.t4.message)||"Unknown error"),alert("Failed to burn vacant accounts: ".concat((null===e.t4||void 0===e.t4?void 0:e.t4.message)||"Please try again.")));case 124:return e.prev=124,console.log("[RentEstimate] Resetting processing state"),S(!1),e.finish(124);case 128:case"end":return e.stop()}}),e,null,[[9,119,124,128],[47,52],[56,82],[64,71],[89,96]])})));return function(){return e.apply(this,arguments)}}();(0,r.useEffect)((function(){var e=setTimeout(B,500);return function(){return clearTimeout(e)}}),[m,B]);var j,R=function(){if(!h)return null;var e=a.length,t=c.length,n=u.length,r=t>10,o=e>10,s=e+t+n,i=e*h.rentPerAccount+t*(h.nftRentPerAsset||h.rentPerAccount),l=.01*i;return{totalSelected:s,selectedTokenCount:e,selectedNFTCount:t,selectedCNFTCount:n,selectedRent:i,feeAmount:l,netSelectedRent:i-l,nftBatchWarning:r,tokenBatchWarning:o,maxNftsPerBatch:10,maxTokensPerBatch:10}}();return m?y?o().createElement("div",{className:"rent-estimate-card"},o().createElement("h3",null,"💰 Rent Return Estimate"),o().createElement("div",{className:"loading-message"},"Calculating potential returns...")):E||!h?o().createElement("div",{className:"rent-estimate-card"},o().createElement("h3",null,"💰 Rent Return Estimate"),o().createElement("div",{className:"error-message"},E||"Unable to calculate estimate")):o().createElement("div",{className:"rent-estimate-card"},o().createElement("h3",null,"💰 Rent Return Estimate"),o().createElement("div",{className:"rent-summary"},R&&R.totalSelected>0?o().createElement("div",{className:"selected-estimate"},o().createElement("div",{className:"current-selection"},o().createElement("span",{className:"estimate-label"},"Selected for Burning:"),o().createElement("span",{className:"estimate-value selected"},R.selectedRent.toFixed(4)," SOL")),o().createElement("div",{className:"selection-breakdown"},o().createElement("small",null,R.selectedTokenCount>0&&"".concat(R.selectedTokenCount," tokens "),R.selectedNFTCount>0&&"".concat(R.selectedNFTCount," NFTs "),R.selectedCNFTCount>0&&"".concat(R.selectedCNFTCount," cNFTs "),"selected (",R.totalSelected," total)",R.selectedCNFTCount>0&&o().createElement("span",{className:"cnft-note"}," • cNFTs don't return rent"))),(R.nftBatchWarning||R.tokenBatchWarning)&&o().createElement("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#4a1a1a",border:"1px solid #ff6b6b",borderRadius:"6px"}},o().createElement("div",{style:{color:"#ff6b6b",fontWeight:"bold",fontSize:"14px",marginBottom:"5px"}},"Batch Size Limit Exceeded"),R.nftBatchWarning&&o().createElement("div",{style:{color:"#ffb3b3",fontSize:"12px"}},"NFTs: ",R.selectedNFTCount,"/",R.maxNftsPerBatch," (max ",R.maxNftsPerBatch," per transaction)"),R.tokenBatchWarning&&o().createElement("div",{style:{color:"#ffb3b3",fontSize:"12px"}},"Tokens: ",R.selectedTokenCount,"/",R.maxTokensPerBatch," (max ",R.maxTokensPerBatch," per transaction)"),o().createElement("div",{style:{color:"#ffcccc",fontSize:"11px",marginTop:"5px"}},"Please select fewer assets to burn them in a single transaction."))):o().createElement("div",{className:"total-estimate"},o().createElement("span",{className:"estimate-label"},"Total Potential Return:"),o().createElement("span",{className:"estimate-value"},(j=.01*h.totalRentEstimate,(h.totalRentEstimate-j).toFixed(4))," SOL")),o().createElement("div",{className:"estimate-breakdown"},o().createElement("div",{className:"breakdown-item"},o().createElement("span",null,"From ",h.nftAccounts," NFT accounts:"),o().createElement("span",null,h.breakdown.nftRent.toFixed(4)," SOL")),o().createElement("div",{className:"breakdown-item"},o().createElement("span",null,"From ",h.tokenAccounts," token accounts:"),o().createElement("span",null,h.breakdown.tokenRent.toFixed(4)," SOL")),h.vacantAccounts>0&&o().createElement("div",{className:"breakdown-item"},o().createElement("span",null,"From ",h.vacantAccounts," vacant accounts:"),o().createElement("span",null,h.breakdown.vacantRent.toFixed(4)," SOL"))),o().createElement("div",{className:"rent-details"},o().createElement("small",null,"Tokens: ",h.rentPerAccount.toFixed(4)," SOL • NFTs: ",(h.nftRentPerAsset||h.rentPerAccount).toFixed(4)," SOL each",R&&R.totalSelected>0&&o().createElement("span",{className:"selection-note"}," • Select assets to see live estimate"))),h&&h.vacantAccounts>0&&h.breakdown.vacantRent>0&&o().createElement("div",{className:"vacant-burn-section-prominent",style:{marginTop:"25px",marginBottom:"20px",padding:"20px",border:"3px solid #ff6600",borderRadius:"15px",background:"linear-gradient(135deg, #2a1a0f, #1a1a1a)",boxShadow:"0 4px 20px rgba(255, 102, 0, 0.4)",position:"relative",overflow:"hidden"}},o().createElement("div",{style:{position:"absolute",top:"0",left:"0",right:"0",bottom:"0",background:"linear-gradient(45deg, transparent, rgba(255, 102, 0, 0.1), transparent)",animation:"glow-sweep 3s ease-in-out infinite",pointerEvents:"none"}}),o().createElement("div",{style:{marginBottom:"15px",fontSize:"20px",color:"#ff6600",textAlign:"center",fontWeight:"bold",textShadow:"0 0 10px rgba(255, 102, 0, 0.8)",position:"relative",zIndex:1}},"💰 INSTANT SOL RECOVERY AVAILABLE! 💰"),o().createElement("div",{style:{marginBottom:"18px",fontSize:"16px",color:"#ffcc99",textAlign:"center",padding:"12px",backgroundColor:"rgba(255, 102, 0, 0.15)",borderRadius:"10px",border:"2px solid rgba(255, 102, 0, 0.4)",fontWeight:"600",position:"relative",zIndex:1}},"🔥 Found ",h.vacantAccounts," Empty Accounts → Get ",h.breakdown.vacantRent.toFixed(4)," SOL Now!"),o().createElement("div",{style:{display:"flex",gap:"10px",alignItems:"center",position:"relative",zIndex:1}},o().createElement("button",{key:"vacant-burn-".concat(P),className:"vacant-burn-button-mega",onClick:O,onTouchStart:function(e){console.log("[RentEstimate] Touch start detected on vacant burn button"),e.preventDefault()},onTouchEnd:function(e){console.log("[RentEstimate] Touch end detected, triggering burn"),e.preventDefault(),A||O()},disabled:A,style:{padding:"18px 35px",background:A?"#666":"linear-gradient(45deg, #ff4444, #ff6600, #ff8800)",backgroundSize:"200% 200%",animation:A?"none":"gradient-shift 2s ease infinite",color:"white",border:"none",borderRadius:"12px",cursor:A?"not-allowed":"pointer",fontSize:"18px",fontWeight:"bold",textTransform:"uppercase",letterSpacing:"1px",boxShadow:A?"none":"0 6px 25px rgba(255, 68, 68, 0.5)",transform:"scale(1)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",flex:1},onMouseEnter:function(e){if(!A){var t=e.target;t.style.transform="scale(1.05) translateY(-2px)",t.style.boxShadow="0 8px 30px rgba(255, 68, 68, 0.7)"}},onMouseLeave:function(e){if(!A){var t=e.target;t.style.transform="scale(1) translateY(0)",t.style.boxShadow="0 6px 25px rgba(255, 68, 68, 0.5)"}}},A?"⏳ PROCESSING...":"🚀 RECOVER ".concat(h.breakdown.vacantRent.toFixed(4)," SOL NOW! 🚀")),A&&o().createElement("button",{onClick:C,style:{padding:"8px 15px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},title:"Reset if button gets stuck"},"Reset"))))):null};function lt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const ut=function(){var e,t,n=(0,i.vT)().publicKey,a=(e=(0,r.useState)(!0),t=2,function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return lt(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),s=a[0],c=a[1],l=function(){var e=localStorage.getItem("solburnt-recent-activity");if(!e)return[];try{var t=JSON.parse(e),n=Date.now()-864e5;return t.filter((function(e){return e.timestamp>n})).sort((function(e,t){return t.timestamp-e.timestamp})).slice(0,10)}catch(e){return[]}};return n?o().createElement("div",{className:"recent-activity"},o().createElement("div",{className:"section-header",onClick:function(){return c(!s)}},o().createElement("h3",null,"📈 Recent Activity"),o().createElement("span",{className:"toggle-icon"},s?"−":"+")),s&&o().createElement("div",{className:"recent-activity-content"},o().createElement("div",{className:"activity-feed"},l().length>0?l().map((function(e,t){return o().createElement("div",{key:t,className:"activity-item"},o().createElement("div",{className:"activity-icon"},"nft-burn"===e.type&&"🔥","token-burn"===e.type&&"💰","vacant-burn"===e.type&&"🗑️","resize"===e.type&&"📏"),o().createElement("div",{className:"activity-details"},o().createElement("div",{className:"activity-title"},e.title),o().createElement("div",{className:"activity-desc"},e.description)),o().createElement("div",{className:"activity-recovery"},"+",e.recovery.toFixed(4)," SOL"),o().createElement("div",{className:"activity-time"},e.time))})):o().createElement("div",{className:"no-activity"},o().createElement("div",{className:"no-activity-icon"},"💤"),o().createElement("div",{className:"no-activity-text"},o().createElement("div",null,"No recent activity"),o().createElement("div",{className:"no-activity-desc"},"Your successful burns will appear here")))),o().createElement("div",{className:"activity-summary"},o().createElement("div",{className:"summary-stat"},o().createElement("span",{className:"stat-label"},"Total Recovered Today"),o().createElement("span",{className:"stat-value"},l().reduce((function(e,t){return e+t.recovery}),0).toFixed(4)," SOL")),o().createElement("div",{className:"summary-stat"},o().createElement("span",{className:"stat-label"},"Transactions"),o().createElement("span",{className:"stat-value"},l().length)))),o().createElement("style",{jsx:!0},"\n        .recent-activity {\n          background: rgba(255, 255, 255, 0.05);\n          border-radius: 12px;\n          padding: 20px;\n          margin-bottom: 20px;\n        }\n        \n        .section-header {\n          display: flex;\n          justify-content: space-between;\n          align-items: center;\n          cursor: pointer;\n          user-select: none;\n        }\n        \n        .section-header h3 {\n          margin: 0;\n          color: #fff;\n          font-size: 18px;\n        }\n        \n        .toggle-icon {\n          color: #9945FF;\n          font-size: 20px;\n          font-weight: bold;\n        }\n        \n        .recent-activity-content {\n          margin-top: 20px;\n        }\n        \n        .activity-feed {\n          max-height: 300px;\n          overflow-y: auto;\n          margin-bottom: 20px;\n        }\n        \n        .activity-item {\n          display: flex;\n          align-items: center;\n          gap: 12px;\n          padding: 12px;\n          background: rgba(255, 255, 255, 0.03);\n          border-radius: 8px;\n          margin-bottom: 8px;\n          border-left: 3px solid #9945FF;\n        }\n        \n        .activity-icon {\n          font-size: 20px;\n          width: 24px;\n          text-align: center;\n        }\n        \n        .activity-details {\n          flex: 1;\n        }\n        \n        .activity-title {\n          font-weight: 600;\n          color: #fff;\n          margin-bottom: 4px;\n        }\n        \n        .activity-desc {\n          color: #aaa;\n          font-size: 14px;\n        }\n        \n        .activity-recovery {\n          color: #22c55e;\n          font-weight: 600;\n          font-size: 14px;\n        }\n        \n        .activity-time {\n          color: #888;\n          font-size: 12px;\n          min-width: 50px;\n          text-align: right;\n        }\n        \n        .no-activity {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          padding: 40px 20px;\n          text-align: center;\n        }\n        \n        .no-activity-icon {\n          font-size: 48px;\n          margin-bottom: 16px;\n          opacity: 0.5;\n        }\n        \n        .no-activity-text {\n          color: #aaa;\n        }\n        \n        .no-activity-desc {\n          font-size: 14px;\n          margin-top: 8px;\n          opacity: 0.7;\n        }\n        \n        .activity-summary {\n          display: flex;\n          gap: 20px;\n          padding: 16px;\n          background: rgba(153, 69, 255, 0.1);\n          border-radius: 8px;\n        }\n        \n        .summary-stat {\n          display: flex;\n          flex-direction: column;\n          gap: 4px;\n        }\n        \n        .stat-label {\n          color: #aaa;\n          font-size: 14px;\n        }\n        \n        .stat-value {\n          color: #fff;\n          font-weight: 600;\n          font-size: 16px;\n        }\n      ")):null};var dt=n(48287).Buffer;function ft(e){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ft(e)}function mt(e){return function(e){if(Array.isArray(e))return Ct(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||It(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){ht(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ht(e,t,n){return(t=function(e){var t=function(e){if("object"!=ft(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ft(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=It(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw a}}}}function bt(){var e=kt(),t=e.m(bt),n=(Object.getPrototypeOf?Object.getPrototypeOf(t):t.__proto__).constructor;function r(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===n||"GeneratorFunction"===(t.displayName||t.name))}var o={throw:1,return:2,break:3,continue:3};function a(e){var t,n;return function(r){t||(t={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(e,t){return n(r.a,o[e],t)},delegateYield:function(e,o,a){return t.resultName=o,n(r.d,yt(e),a)},finish:function(e){return n(r.f,e)}},n=function(e,n,o){r.p=t.prev,r.n=t.next;try{return e(n,o)}finally{t.next=r.n}}),t.resultName&&(t[t.resultName]=r.v,t.resultName=void 0),t.sent=r.v,t.next=r.n;try{return e.call(this,t)}finally{r.p=t.prev,r.n=t.next}}}return(bt=function(){return{wrap:function(t,n,r,o){return e.w(a(t),n,r,o&&o.reverse())},isGeneratorFunction:r,mark:e.m,awrap:function(e,t){return new At(e,t)},AsyncIterator:Et,async:function(e,t,n,o,s){return(r(t)?xt:Tt)(a(e),t,n,o,s)},keys:vt,values:yt}})()}function yt(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],n=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}throw new TypeError(ft(e)+" is not iterable")}function vt(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}}function Tt(e,t,n,r,o){var a=xt(e,t,n,r,o);return a.next().then((function(e){return e.done?e.value:a.next()}))}function xt(e,t,n,r,o){return new Et(kt().w(e,t,n,r),o||Promise)}function Et(e,t){function n(r,o,a,s){try{var i=e[r](o),c=i.value;return c instanceof At?t.resolve(c.v).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(c).then((function(e){i.value=e,a(i)}),(function(e){return n("throw",e,a,s)}))}catch(e){s(e)}}var r;this.next||(Nt(Et.prototype),Nt(Et.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),Nt(this,"_invoke",(function(e,o,a){function s(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(s,s):s()}),!0)}function kt(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function a(n,r,o,a){var c=r&&r.prototype instanceof i?r:i,l=Object.create(c.prototype);return Nt(l,"_invoke",function(n,r,o){var a,i,c,l=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:m,f:m.bind(e,4),d:function(t,n){return a=t,i=0,c=e,f.n=n,s}};function m(n,r){for(i=n,c=r,t=0;!d&&l&&!o&&t<u.length;t++){var o,a=u[t],m=f.p,p=a[2];n>3?(o=p===r)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=e):a[0]<=m&&((o=n<2&&m<a[1])?(i=0,f.v=r,f.n=a[1]):m<p&&(o=n<3||a[0]>r||r>p)&&(a[4]=n,a[5]=r,f.n=p,i=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,p){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&m(u,p),i=u,c=p;(t=i<2?e:c)||!d;){a||(i?i<3?(i>1&&(f.n=-1),m(i,c)):f.n=c:f.v=c);try{if(l=2,a){if(i||(o="next"),t=a[o]){if(!(t=t.call(a,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,i<2&&(i=0)}else 1===i&&(t=a.return)&&t.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),i=1);a=e}else if((t=(d=f.n<0)?c:n.call(r,f))!==s)break}catch(t){a=e,i=1,c=t}finally{l=1}}return{value:t,done:d}}}(n,o,a),!0),l}var s={};function i(){}function c(){}function l(){}t=Object.getPrototypeOf;var u=[][r]?t(t([][r]())):(Nt(t={},r,(function(){return this})),t),d=l.prototype=i.prototype=Object.create(u);function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,Nt(e,o,"GeneratorFunction")),e.prototype=Object.create(d),e}return c.prototype=l,Nt(d,"constructor",l),Nt(l,"constructor",c),c.displayName="GeneratorFunction",Nt(l,o,"GeneratorFunction"),Nt(d),Nt(d,o,"Generator"),Nt(d,r,(function(){return this})),Nt(d,"toString",(function(){return"[object Generator]"})),(kt=function(){return{w:a,m:f}})()}function Nt(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}Nt=function(e,t,n,r){function a(t,n){Nt(e,t,(function(e){return this._invoke(t,n,e)}))}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(a("next",0),a("throw",1),a("return",2))},Nt(e,t,n,r)}function At(e,t){this.v=e,this.k=t}function St(e,t,n,r,o,a,s){try{var i=e[a](s),c=i.value}catch(e){return void n(e)}i.done?t(c):Promise.resolve(c).then(r,o)}function Ft(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){St(a,r,o,s,i,"next",e)}function i(e){St(a,r,o,s,i,"throw",e)}s(void 0)}))}}function Pt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(e,t)||It(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function It(e,t){if(e){if("string"==typeof e)return Ct(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ct(e,t):void 0}}function Ct(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}"undefined"!=typeof window&&(window.debugInfo={lastCnftError:null,lastCnftData:null,cnftBurnTriggered:!1,lastCnftSuccess:!1,lastCnftSignature:"",lastCnftAssumedSuccess:!1,walletInfo:null});const Bt=function(){var e=(0,i.w5)().connection,t=(0,i.vT)(),a=t.publicKey,s=t.signTransaction,d=t.connected,m=Pt((0,r.useState)([]),2),p=m[0],g=m[1],h=Pt((0,r.useState)([]),2),w=h[0],b=h[1],y=Pt((0,r.useState)([]),2),x=y[0],E=y[1],k=Pt((0,r.useState)(!1),2),N=k[0],A=k[1],S=Pt((0,r.useState)(!1),2),F=S[0],P=S[1],I=Pt((0,r.useState)(!1),2),C=I[0],B=I[1],O=Pt((0,r.useState)(null),2),j=O[0],R=O[1],_=Pt((0,r.useState)(!0),2),M=_[0],D=_[1],W=Pt((0,r.useState)([]),2),U=W[0],K=W[1],H=Pt((0,r.useState)([]),2),$=H[0],q=H[1],z=Pt((0,r.useState)([]),2),L=z[0],G=z[1],V=Pt((0,r.useState)(!1),2),Y=(V[0],V[1]),J=Pt((0,r.useState)(null),2),Q=J[0],X=J[1],Z=Pt((0,r.useState)(!1),2),ee=Z[0],te=Z[1],ne=Pt((0,r.useState)(null),2),re=ne[0],oe=ne[1],ae=Pt((0,r.useState)(!1),2),se=ae[0],ie=ae[1],ce=Pt((0,r.useState)([]),2),le=ce[0],ue=ce[1],de=Pt((0,r.useState)(!1),2),me=de[0],pe=de[1],ge=Pt((0,r.useState)(null),2),he=ge[0];ge[1],(0,r.useEffect)((function(){var e=function(){var e=Ft(bt().mark((function e(){var t;return bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f().get("/api/config");case 3:(t=e.sent).data&&t.data.solscanApiKey?(console.log("[WalletAssets] API key status:","Present"),X(t.data.solscanApiKey)):console.log("[WalletAssets] API key status:","Missing"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("[WalletAssets] Failed to fetch API key:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,r.useEffect)((function(){a&&d?(console.log("[WalletAssets] Wallet connected, storing debug info"),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.walletInfo={publicKey:a.toString(),hasSignTransaction:!!s})):d||(console.log("[WalletAssets] Wallet disconnected, clearing data"),g([]),b([]),E([]),K([]),q([]),G([]),R(null),A(!1),P(!1),B(!1))}),[a,d,s]),(0,r.useEffect)((function(){var t=function(){var t=Ft(bt().mark((function t(){var n,r,o,s,i,c,l,m,p,h,w,b,y,v,T,x,E,k,N,S,F;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=!!a,r=!!Q,console.log("[WalletAssets] Token fetch effect triggered",{hasPublicKey:n,hasSolscanKey:r}),a&&d){t.next=5;break}return t.abrupt("return");case 5:return t.prev=5,console.log("[WalletAssets] Starting token fetch"),A(!0),R(null),console.log("[WalletAssets] Fetching token accounts via Helius API"),o=[],t.prev=11,t.next=14,fetch("/api/wallet-tokens/".concat(a.toString()));case 14:if(!(s=t.sent).ok){t.next=23;break}return t.next=18,s.json();case 18:if(i=t.sent,console.log("[WalletAssets] Helius token response:",i),i.success&&i.tokens){c=wt(i.tokens);try{for(c.s();!(l=c.n()).done;)(m=l.value).amount>0&&(1!==m.amount||0!==m.decimals)&&o.push({mint:m.mint,balance:m.amount,decimals:m.decimals,account:m.tokenAccount})}catch(e){c.e(e)}finally{c.f()}}t.next=29;break;case 23:if(503!==s.status){t.next=28;break}throw console.warn("[WalletAssets] Helius API temporarily unavailable (503), using fallback"),new Error("API temporarily unavailable");case 28:throw new Error("Helius API returned ".concat(s.status));case 29:t.next=46;break;case 31:return t.prev=31,t.t0=t.catch(11),console.warn("[WalletAssets] Helius API failed, trying direct RPC:",t.t0),t.prev=34,t.next=37,e.getParsedTokenAccountsByOwner(a,{programId:u.x5H});case 37:p=t.sent,console.log("[WalletAssets] Fallback RPC found token accounts:",p.value.length),h=wt(p.value);try{for(h.s();!(w=h.n()).done;)b=w.value,y=b.account.data.parsed.info,v=Number(y.tokenAmount.amount),T=y.tokenAmount.decimals,v>0&&(1!==v||0!==T)&&o.push({mint:y.mint,balance:v,decimals:T,account:b.pubkey.toBase58()})}catch(e){h.e(e)}finally{h.f()}t.next=46;break;case 43:t.prev=43,t.t1=t.catch(34),console.warn("[WalletAssets] Both Helius and RPC failed:",t.t1);case 46:console.log("[WalletAssets] Filtered token data:",o.length),g(o),x=function(){var e=Ft(bt().mark((function e(t){var n,r,o,a,s,i,c,l,u,d=arguments;return bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.length>1&&void 0!==d[1]?d[1]:0,e.prev=1,e.next=4,new Promise((function(e){return setTimeout(e,1e3*n)}));case 4:return console.log("[WalletAssets] Fetching metadata for token ".concat(t," (attempt ").concat(n+1,")")),console.log("[WalletAssets] Using Solscan API key: ".concat(Q?"Present (length: "+Q.length+")":"Missing")),o="/api/token-metadata/".concat(t),console.log("[WalletAssets] Using proxy endpoint: ".concat(o)),e.next=10,f().get(o,{timeout:1e4});case 10:if(a=e.sent,console.log("[WalletAssets] Solscan response status:",a.status),console.log("[WalletAssets] Solscan response data:",a.data),null!==(r=a.data)&&void 0!==r&&r.success){e.next=16;break}throw console.error("[WalletAssets] Invalid response format from Solscan:",a.data),new Error("Invalid response format");case 16:return e.abrupt("return",a.data);case 19:if(e.prev=19,e.t0=e.catch(1),console.error("[WalletAssets] Error fetching metadata for token ".concat(t,":"),null===(s=e.t0.response)||void 0===s?void 0:s.status,null===(i=e.t0.response)||void 0===i?void 0:i.statusText),console.error("[WalletAssets] Error details:",(null===(c=e.t0.response)||void 0===c?void 0:c.data)||e.t0.message),!(429===(null===(l=e.t0.response)||void 0===l?void 0:l.status)&&n<3)){e.next=26;break}return console.warn("[WalletAssets] Rate limit hit for ".concat(t,", retrying in ").concat(1e3*(n+1),"ms")),e.abrupt("return",x(t,n+1));case 26:throw 401===(null===(u=e.t0.response)||void 0===u?void 0:u.status)&&console.error("[WalletAssets] Authentication error with Solscan API. Please check your API key."),e.t0;case 28:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(t){return e.apply(this,arguments)}}(),E=3,k=[],N=0;case 52:if(!(N<o.length)){t.next=68;break}return S=o.slice(N,N+E),console.log("[WalletAssets] Processing batch ".concat(N/E+1)),t.prev=55,t.next=58,Promise.all(S.map(function(){var e=Ft(bt().mark((function e(t){var n,r,o,a;return bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x(t.mint);case 3:return n=e.sent,console.log("[WalletAssets] Metadata response for token ".concat(t.mint,":"),n),r=n.data||{},console.log("[WalletAssets] Successfully enriched token ".concat(t.mint," with metadata:"),r),o=t.decimals||r.decimals||9,"DwLwu4FaSn39zkoCtozTMcmJLvMFNxgrbHoFxm9fzYFt"===t.mint&&(o=0,console.log("Forcing decimals to 0 for DwLw token at WalletAssets enrichment stage")),e.abrupt("return",gt(gt({},t),{},{symbol:r.symbol||t.mint.slice(0,4),name:r.name||"Token ".concat(t.mint.slice(0,8),"..."),logoURI:r.icon||"/default-token-icon.svg",decimals:o,metadataUri:r.uri||null}));case 12:return e.prev=12,e.t0=e.catch(0),console.warn("[WalletAssets] Failed to fetch metadata for token ".concat(t.mint,", using fallback data")),a=t.decimals,"DwLwu4FaSn39zkoCtozTMcmJLvMFNxgrbHoFxm9fzYFt"===t.mint&&(a=0,console.log("Forcing decimals to 0 for DwLw token at WalletAssets fallback stage")),e.abrupt("return",gt(gt({},t),{},{symbol:"Unknown",name:"Unknown Token",logoURI:"/default-token-icon.svg",decimals:a}));case 18:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}()));case 58:F=t.sent,k.push.apply(k,mt(F)),t.next=65;break;case 62:t.prev=62,t.t2=t.catch(55),console.error("[WalletAssets] Error processing batch:",t.t2);case 65:N+=E,t.next=52;break;case 68:console.log("[WalletAssets] Token enrichment completed:",k.length),g(k),A(!1),t.next=78;break;case 73:t.prev=73,t.t3=t.catch(5),console.error("[WalletAssets] Error fetching tokens:",t.t3),R("Error fetching tokens: ".concat(t.t3.message)),A(!1);case 78:case"end":return t.stop()}}),t,null,[[5,73],[11,31],[34,43],[55,62]])})));return function(){return t.apply(this,arguments)}}();t()}),[a,d,e,Q]),(0,r.useEffect)((function(){var t=function(){var e=Ft(bt().mark((function e(){var t,o,i,c,l,u,d,m,p,g,h,y,v,T;return bt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return P(!0),B(!0),R(null),e.prev=5,console.log("[WalletAssets] Fetching all NFTs (regular + compressed) using Helius v0 API..."),t=a.toBase58(),e.next=10,f().get("/api/helius/wallet/nfts/".concat(t));case 10:if((o=e.sent).data&&o.data.success){e.next=14;break}throw console.error("[WalletAssets] Invalid response from Helius v0 API:",o.data),new Error("Invalid response from Helius v0 API");case 14:i=o.data.data,c=i.regularNfts,l=i.compressedNfts,console.log("[WalletAssets] Found ".concat(c.length," regular NFTs and ").concat(l.length," compressed NFTs via Helius v0 API")),b(c),P(!1),u=l,"undefined"!=typeof window&&window.HiddenAssets&&(console.log("[WalletAssets] Filtering out hidden cNFTs from Helius API results"),u=l.filter((function(e){var t;return!(null!==(t=window.HiddenAssets)&&void 0!==t&&t.isAssetHidden(e.mint))})),(d=l.length-u.length)>0&&console.log("[WalletAssets] Filtered out ".concat(d," hidden cNFTs from Helius API results"))),E(u),B(!1),e.next=69;break;case 24:if(e.prev=24,e.t0=e.catch(5),console.error("[WalletAssets] Error fetching NFTs via Helius v0 API:",e.t0),e.prev=27,console.log("[WalletAssets] Falling back to separate Helius API endpoints..."),e.prev=29,!a){e.next=36;break}return m=a.toBase58(),e.next=34,f().get("/api/helius/assets/".concat(m));case 34:(p=e.sent).data&&p.data.success&&(g=p.data.data||[],h=g.filter((function(e){return!e.compressed})),console.log("[WalletAssets] Found ".concat(h.length," regular NFTs via fallback method")),b(h));case 36:e.next=41;break;case 38:e.prev=38,e.t1=e.catch(29),console.error("[WalletAssets] Error in fallback regular NFT fetching:",e.t1);case 41:if(e.prev=41,!a){e.next=48;break}return y=a.toBase58(),e.next=46,f().get("/api/helius/cnfts/".concat(y));case 46:(v=e.sent).data&&v.data.success&&(T=v.data.data||[],console.log("[WalletAssets] Found ".concat(T.length," compressed NFTs via fallback method")),E(T));case 48:e.next=53;break;case 50:e.prev=50,e.t2=e.catch(41),console.error("[WalletAssets] Error in fallback compressed NFT fetching:",e.t2);case 53:if(w.length){e.next=56;break}return e.next=56,n();case 56:if(x.length||!s){e.next=59;break}return e.next=59,r();case 59:e.next=65;break;case 61:e.prev=61,e.t3=e.catch(27),console.error("[WalletAssets] Error in all fallback methods:",e.t3),R("Error fetching NFTs: ".concat(e.t0.message));case 65:return e.prev=65,P(!1),B(!1),e.finish(65);case 69:case"end":return e.stop()}}),e,null,[[5,24],[27,61,65,69],[29,38],[41,50]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var t=Ft(bt().mark((function t(){var n,r,o,s,i,c,d,m;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a){t.next=4;break}return console.warn("[WalletAssets] Cannot fetch NFTs - no wallet connected"),t.abrupt("return");case 4:return console.log("[WalletAssets] Falling back to on-chain NFT fetching..."),t.next=7,e.getParsedTokenAccountsByOwner(a,{programId:u.x5H});case 7:n=t.sent,r=n.value.filter((function(e){var t=e.account.data.parsed.info.tokenAmount;return"1"===t.amount&&0===t.decimals})),console.log("[WalletAssets] Found ".concat(r.length," NFT accounts via on-chain method")),o=3,s=[],i=0;case 13:if(!(i<r.length)){t.next=27;break}return c=r.slice(i,i+o),console.log("[WalletAssets] Processing NFT batch ".concat(Math.floor(i/o)+1,"/").concat(Math.ceil(r.length/o))),d=c.map(function(){var t=Ft(bt().mark((function t(n){var r,o,a,s,i,c,u,d,m,p,g,h,w,b;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=n.account.data.parsed.info,s=a.mint,y=new l.PublicKey(s),v=void 0,void 0,v=new l.PublicKey("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),T=Pt(l.PublicKey.findProgramAddressSync([dt.from("metadata"),v.toBuffer(),y.toBuffer()],v),1)[0],i=T,t.next=6,e.getAccountInfo(i);case 6:if(c=t.sent){t.next=10;break}return console.log("[WalletAssets] No metadata found for NFT: ".concat(s)),t.abrupt("return",null);case 10:if(u=dt.from(c.data).toString(),d=u.match(/https?:\/\/\S+/)){t.next=15;break}return console.log("[WalletAssets] No URI found in metadata for NFT: ".concat(s)),t.abrupt("return",null);case 15:return m=d[0].split("\0")[0],p={},t.prev=17,console.log("[WalletAssets] Fetching NFT metadata from: ".concat(m)),t.next=21,f().get(m);case 21:g=t.sent,p=g.data,t.next=28;break;case 25:t.prev=25,t.t0=t.catch(17),console.error("[WalletAssets] Error fetching NFT metadata from URI: ".concat(m),t.t0);case 28:return h=u.match(/"name":"([^"]+)"/),w=p.name||(h?h[1]:"NFT ".concat(s.slice(0,6))),b=p.image||"/default-nft-image.svg",t.abrupt("return",{mint:s,name:w,image:b,collection:(null===(r=p.collection)||void 0===r?void 0:r.name)||(null===(o=p.collection)||void 0===o?void 0:o.family)||"Unknown Collection",tokenAddress:n.pubkey.toBase58(),metadataAddress:i.toBase58()});case 34:return t.prev=34,t.t1=t.catch(0),console.error("[WalletAssets] Error processing NFT:",t.t1),t.abrupt("return",null);case 38:case"end":return t.stop()}var y,v,T}),t,null,[[0,34],[17,25]])})));return function(e){return t.apply(this,arguments)}}()),t.next=19,Promise.all(d);case 19:if(m=t.sent,s.push.apply(s,mt(m.filter(Boolean))),!(i+o<r.length)){t.next=24;break}return t.next=24,new Promise((function(e){return setTimeout(e,500)}));case 24:i+=o,t.next=13;break;case 27:console.log("[WalletAssets] Successfully processed ".concat(s.length," NFTs via on-chain method")),b(s),t.next=35;break;case 31:throw t.prev=31,t.t0=t.catch(0),console.error("[WalletAssets] Error in on-chain NFT fetching:",t.t0),t.t0;case 35:case"end":return t.stop()}}),t,null,[[0,31]])})));return function(){return t.apply(this,arguments)}}(),r=function(){var t=Ft(bt().mark((function t(){var n,r,o,i;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,a){t.next=4;break}return console.warn("[WalletAssets] Cannot fetch cNFTs - no wallet connected"),t.abrupt("return");case 4:if(console.log("[WalletAssets] Falling back to CNFTHandler method..."),s){t.next=7;break}throw new Error("Wallet signTransaction capability required for CNFTHandler");case 7:return n=new v(e,{publicKey:a,signTransaction:s}),t.next=10,n.fetchCNFTs(a.toBase58());case 10:r=t.sent,o=r,"undefined"!=typeof window&&window.HiddenAssets&&(console.log("[WalletAssets] Filtering out hidden assets from display"),o=r.filter((function(e){var t;return!(null!==(t=window.HiddenAssets)&&void 0!==t&&t.isAssetHidden(e.mint))})),(i=r.length-o.length)>0&&console.log("[WalletAssets] Filtered out ".concat(i," hidden cNFTs from display"))),console.log("[WalletAssets] Found ".concat(r.length," compressed NFTs (").concat(o.length," visible) via CNFTHandler")),E(o),t.next=21;break;case 17:throw t.prev=17,t.t0=t.catch(0),console.error("[WalletAssets] Error in CNFTHandler method:",t.t0),t.t0;case 21:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(){return t.apply(this,arguments)}}();t()}),[a,e,s]);var we=function(){var t=Ft(bt().mark((function t(r){var o,i,c,d,f,m,h,w,b,y,v,x,E,k,N,A,S,F,P,I,C,B,O;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Burning token:",r),a&&s){t.next=5;break}return console.error("Wallet connection required for burning tokens"),R("Wallet connection required for burning tokens"),t.abrupt("return");case 5:return t.prev=5,o=n(13364),i=o.ComputeBudgetProgram,c=new l.Transaction,d=i.setComputeUnitLimit({units:2e5}),f=i.setComputeUnitPrice({microLamports:1}),c.add(d,f),c.add((0,u.Rjp)(new l.PublicKey(r.account||""),new l.PublicKey(r.mint),a,r.balance,r.decimals)),c.add((0,u.wyB)(new l.PublicKey(r.account||""),a,a,[])),t.next=15,e.getLatestBlockhash({commitment:"processed"});case 15:return m=t.sent,h=m.blockhash,w=m.lastValidBlockHeight,c.recentBlockhash=h,c.feePayer=a,y=new Promise((function(e,t){b=setTimeout((function(){t(new Error("Transaction signing timed out or was cancelled"))}),12e4)})),t.prev=21,t.next=24,Promise.race([s(c),y]);case 24:return v=t.sent,clearTimeout(b),t.next=28,e.sendRawTransaction(v.serialize(),{skipPreflight:!0,maxRetries:3,preflightCommitment:"processed"});case 28:return x=t.sent,console.log("Transaction sent, waiting for confirmation..."),t.next=32,e.confirmTransaction({signature:x,blockhash:h,lastValidBlockHeight:w},"processed");case 32:if(E=t.sent,console.log("Confirmation result:",E),E.value.err){if(console.error("Error confirming burn transaction:",E.value.err),k="Transaction failed",E.value.err)try{k=JSON.stringify(E.value.err)}catch(e){k=String(E.value.err)}R("Error burning token: ".concat(k))}else console.log("Token burn successful with signature:",x),N=p.filter((function(e){return e.mint!==r.mint})),g(N),window.BurnAnimations&&window.BurnAnimations.createConfetti&&window.BurnAnimations.createConfetti(),window.BurnAnimations&&window.BurnAnimations.checkAchievements&&window.BurnAnimations.checkAchievements("tokens",1),A=.00204,S="https://solscan.io/tx/".concat(x),F=x.substring(0,8)+"...",R("Successfully burned ".concat(r.name||r.symbol||"token","! Rent returned: ").concat(A.toFixed(4)," SOL | Signature: ").concat(F)),T.ActivityLogger.logTokenBurn(r.name||r.symbol||"Token",A,x),setTimeout((function(){var e,t=document.createElement("div");t.innerHTML='<a href="'.concat(S,'" target="_blank" rel="noopener noreferrer" style="color: #4da6ff; text-decoration: underline;">View transaction</a>'),document.querySelector(".error-message")&&(null===(e=document.querySelector(".error-message"))||void 0===e||e.appendChild(t))}),100),setTimeout((function(){return R(null)}),8e3);t.next=46;break;case 37:if(t.prev=37,t.t0=t.catch(21),clearTimeout(b),!((P=(null===t.t0||void 0===t.t0?void 0:t.t0.message)||"").includes("timed out")||P.includes("cancelled")||P.includes("rejected")||P.includes("User rejected"))){t.next=45;break}return console.log("Transaction was cancelled by the user or timed out"),R("Transaction was cancelled. Please try again if you want to burn this token."),t.abrupt("return");case 45:throw t.t0;case 46:t.next=55;break;case 48:if(t.prev=48,t.t1=t.catch(5),console.error("Error burning token:",t.t1),I=t.t1.message||"",C=I.includes("insufficient")||I.includes("balance")||I.includes("0x1")||I.includes("fund"),B=I.includes("wallet")||I.includes("connection")||I.includes("adapter"),C)R("Transaction failed due to network fee issues. We've updated the app to fix this. Please try again.");else if(B)R("Wallet connection error. Please check your wallet and try again.");else{if(O="Unknown error occurred",null!==t.t1&&void 0!==t.t1&&t.t1.message)O=t.t1.message;else if("string"==typeof t.t1)O=t.t1;else if(null!==t.t1&&void 0!==t.t1&&t.t1.error)O=t.t1.error;else if(t.t1)try{O=JSON.stringify(t.t1)}catch(e){O=String(t.t1)}R("Error burning token: ".concat(O))}case 55:case"end":return t.stop()}}),t,null,[[5,48],[21,37]])})));return function(e){return t.apply(this,arguments)}}(),be=function(){var t=Ft(bt().mark((function t(r){var o,i,c,d,f,m,p,g,h,y,v,x,E,k,N,A,S,F,P,I,C,B,O,j;return bt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(console.log("Burning NFT:",r),a&&s){t.next=5;break}return console.error("Wallet connection required for burning NFTs"),R("Wallet connection required for burning NFTs"),t.abrupt("return");case 5:if(t.prev=5,o=n(13364),i=o.ComputeBudgetProgram,r.tokenAddress){t.next=11;break}return console.error("Token account address is required for burning NFT"),R("Could not find the token account for this NFT"),t.abrupt("return");case 11:return c=new l.Transaction,d=i.setComputeUnitLimit({units:2e5}),f=i.setComputeUnitPrice({microLamports:1}),c.add(d,f),c.add((0,u.Rjp)(new l.PublicKey(r.tokenAddress),new l.PublicKey(r.mint),a,1,0)),c.add((0,u.wyB)(new l.PublicKey(r.tokenAddress),a,a,[])),t.next=19,e.getLatestBlockhash({commitment:"processed"});case 19:return m=t.sent,p=m.blockhash,g=m.lastValidBlockHeight,c.recentBlockhash=p,c.feePayer=a,y=new Promise((function(e,t){h=setTimeout((function(){t(new Error("Transaction signing timed out or was cancelled"))}),12e4)})),t.prev=25,t.next=28,Promise.race([s(c),y]);case 28:return v=t.sent,clearTimeout(h),t.next=32,e.sendRawTransaction(v.serialize(),{skipPreflight:!0,maxRetries:3,preflightCommitment:"processed"});case 32:return x=t.sent,console.log("Transaction sent, waiting for confirmation..."),t.next=36,e.confirmTransaction({signature:x,blockhash:p,lastValidBlockHeight:g},"processed");case 36:if(E=t.sent,console.log("Confirmation result:",E),E.value.err){if(console.error("Error confirming NFT burn transaction:",E.value.err),k="Transaction failed",E.value.err)try{k=JSON.stringify(E.value.err)}catch(e){k=String(E.value.err)}R("Error burning NFT: ".concat(k))}else console.log("NFT burn successful with signature:",x),N=w.filter((function(e){return e.mint!==r.mint})),b(N),window.BurnAnimations&&((A=document.querySelector('[data-mint="'.concat(r.mint,'"]')))&&window.BurnAnimations.applyBurnAnimation&&window.BurnAnimations.applyBurnAnimation(A),window.BurnAnimations.createConfetti&&window.BurnAnimations.createConfetti(),window.BurnAnimations.checkAchievements&&window.BurnAnimations.checkAchievements("nfts",1)),S=.0077,F="https://solscan.io/tx/".concat(x),P=x.substring(0,8)+"...",R('Successfully burned NFT "'.concat(r.name||"NFT",'"! Rent returned: ').concat(S.toFixed(4)," SOL | Signature: ").concat(P)),T.ActivityLogger.logNFTBurn(r.name||"NFT",S,x),setTimeout((function(){var e,t=document.createElement("div");t.innerHTML='<a href="'.concat(F,'" target="_blank" rel="noopener noreferrer" style="color: #4da6ff; text-decoration: underline;">View transaction</a>'),document.querySelector(".error-message")&&(null===(e=document.querySelector(".error-message"))||void 0===e||e.appendChild(t))}),100),setTimeout((function(){return R(null)}),8e3);t.next=50;break;case 41:if(t.prev=41,t.t0=t.catch(25),clearTimeout(h),!((I=(null===t.t0||void 0===t.t0?void 0:t.t0.message)||"").includes("timed out")||I.includes("cancelled")||I.includes("rejected")||I.includes("User rejected"))){t.next=49;break}return console.log("Transaction was cancelled by the user or timed out"),R("Transaction was cancelled. Please try again if you want to burn this NFT."),t.abrupt("return");case 49:throw t.t0;case 50:t.next=59;break;case 52:if(t.prev=52,t.t1=t.catch(5),console.error("Error burning NFT:",t.t1),C=t.t1.message||"",B=C.includes("insufficient")||C.includes("balance")||C.includes("0x1")||C.includes("fund"),O=C.includes("wallet")||C.includes("connection")||C.includes("adapter"),B)R("Transaction failed due to network fee issues. We've updated the app to fix this. Please try again.");else if(O)R("Wallet connection error. Please check your wallet and try again.");else{if(j="Unknown error occurred",null!==t.t1&&void 0!==t.t1&&t.t1.message)j=t.t1.message;else if("string"==typeof t.t1)j=t.t1;else if(null!==t.t1&&void 0!==t.t1&&t.t1.error)j=t.t1.error;else if(t.t1)try{j=JSON.stringify(t.t1)}catch(e){j=String(t.t1)}R("Error burning NFT: ".concat(j))}case 59:case"end":return t.stop()}}),t,null,[[5,52],[25,41]])})));return function(e){return t.apply(this,arguments)}}(),ye=function(e){re&&ee?(console.log("[WalletAssets] Direct trash operation successful for asset:",re.id),window.debugInfo&&(window.debugInfo.lastCnftSuccess=!0,window.debugInfo.lastCnftSignature=e.signature||"",window.debugInfo.transferMethod="Direct CLI-based transfer")):he&&me&&(console.log("[WalletAssets] Delegated transfer successful for asset:",he.id),console.log("[WalletAssets] Result:",e),window.debugInfo&&(window.debugInfo.lastCnftSuccess=!0,window.debugInfo.lastCnftSignature=e.signature||"",window.debugInfo.transferMethod="Delegated Helius transfer")),e&&e.signature&&console.log("[WalletAssets] Signature:",e.signature),window.BurnAnimations&&(window.BurnAnimations.createConfetti(),window.BurnAnimations.showNotification("cNFT Trashed! 🎉","Successfully trashed ".concat(re.name)),window.BurnAnimations.checkAchievements("trash",1),window.BurnAnimations.checkAchievements("cnfts",1)),E((function(e){return e.filter((function(e){return e.mint!==re.id}))})),te(!1),oe(null),R('Successfully trashed compressed NFT "'.concat(re.name,'" via direct method! ').concat(e.signature?"Transaction: ".concat(e.signature.substring(0,8),"..."):"")),setTimeout((function(){return R(null)}),8e3)},ve=function(e){q((function(t){return t.includes(e)?t.filter((function(t){return t!==e})):[].concat(mt(t),[e])}))};return o().createElement("div",{className:"wallet-assets-container"},!a&&o().createElement("div",{className:"wallet-connect-section"},o().createElement("div",{className:"app-header"},o().createElement("img",{src:"/static/solburnt-logo-pixel.png",alt:"Solburnt",className:"app-logo",style:{height:"80px",marginBottom:"20px",filter:"drop-shadow(0 0 10px rgba(255, 100, 0, 0.3))",imageRendering:"pixelated"}})),o().createElement("h2",null,"Connect Wallet to View Assets"),o().createElement(c.xO,null)),a&&o().createElement("div",{className:"assets-section"},o().createElement("div",{className:"wallet-header"},o().createElement("div",{className:"header-left"},o().createElement("img",{src:"/static/solburnt-logo-pixel.png",alt:"Solburnt",className:"header-logo",style:{height:"40px",marginRight:"15px",filter:"drop-shadow(0 0 8px rgba(255, 100, 0, 0.3))",imageRendering:"pixelated"}}),o().createElement("h2",null,"Your Wallet Assets")),o().createElement("div",{className:"header-right"},o().createElement("button",{className:"bulk-mode-toggle ".concat(M?"active":""),onClick:function(){D(!M),M&&(K([]),q([]),G([]))},style:{backgroundColor:M?"#9945FF":"transparent",color:M?"white":"#9945FF",border:"2px solid #9945FF",padding:"10px 20px",borderRadius:"8px",fontSize:"14px",fontWeight:"bold",cursor:"pointer",marginRight:"15px",transition:"all 0.2s ease"}},M?"✓ Bulk Mode ON":"Bulk Select Mode"),o().createElement(c.xO,null))),o().createElement(ct,{selectedTokens:U,selectedNFTs:$,selectedCNFTs:L}),o().createElement(ut,null),a&&o().createElement("div",{className:"bulk-burn-section"},o().createElement("div",{className:"bulk-burn-panel"},o().createElement("div",{className:"bulk-burn-header"},o().createElement("h3",null,"Selected Assets"),o().createElement("span",{className:"selection-count"},U.length+$.length+L.length," items selected")),L.length>0&&o().createElement("div",{className:"selection-group cnft-selection-group"},o().createElement("span",null,L.length," cNFTs selected - View Only (Transfer disabled)")),U.length+$.length+L.length===0&&o().createElement("div",{className:"no-selection-message"},"Click on any asset to select it. You can select multiple tokens/NFTs to burn or cNFTs to trash."))),j&&o().createElement("div",{className:"error-message"},j),o().createElement("div",{className:"asset-section"},o().createElement("h3",null,"Tokens ",N&&o().createElement("span",{className:"loading-indicator"},"Loading...")),o().createElement("div",{className:"tokens-grid"},p.map((function(e){return o().createElement("div",{key:e.mint,className:"token-card ".concat(M&&U.includes(e.mint)?"selected":""),"data-mint":e.mint,onClick:M?function(){return t=e.mint,void K((function(e){return e.includes(t)?e.filter((function(e){return e!==t})):[].concat(mt(e),[t])}));var t}:void 0},o().createElement("div",{className:"token-info"},o().createElement("img",{src:e.logoURI||"/default-token-icon.svg",alt:e.symbol||"Token",className:"token-icon",onError:function(e){e.target.src="/default-token-icon.svg"}}),o().createElement("div",{className:"token-details"},o().createElement("div",{className:"token-name"},e.name||"Token ".concat(e.mint.slice(0,8),"...")),o().createElement("div",{className:"token-symbol"},e.symbol||e.mint.slice(0,4)),o().createElement("div",{className:"token-balance"},(t=e.balance,n=e.decimals,(r=t/Math.pow(10,n)).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:r<.001?8:4}))))),!M&&o().createElement("button",{className:"burn-button",onClick:function(t){t.stopPropagation(),we(e)}},"Burn"),M&&o().createElement("div",{className:"selection-indicator"},U.includes(e.mint)?"✓":""));var t,n,r})),!N&&0===p.length&&o().createElement("div",{className:"no-assets-message"},"No tokens found in this wallet"))),o().createElement("div",{className:"asset-section"},o().createElement("h3",null,"NFTs ",F&&o().createElement("span",{className:"loading-indicator"},"Loading...")),o().createElement("div",{className:"nfts-grid"},w.map((function(e){return o().createElement("div",{key:e.mint,className:"nft-card ".concat(M&&$.includes(e.mint)?"selected":""),"data-mint":e.mint,onClick:M?function(){return ve(e.mint)}:void 0},M&&o().createElement("div",{className:"nft-header",style:{position:"absolute",top:"8px",left:"8px",zIndex:1e3,backgroundColor:"rgba(153, 69, 255, 0.9)",padding:"8px",borderRadius:"8px",border:"2px solid #9945FF",display:"flex",alignItems:"center"}},o().createElement("input",{type:"checkbox",checked:$.includes(e.mint),onChange:function(){return ve(e.mint)},onClick:function(e){return e.stopPropagation()},style:{width:"18px",height:"18px",cursor:"pointer",accentColor:"#9945FF"}}),o().createElement("span",{style:{color:"white",fontSize:"11px",marginLeft:"4px",fontWeight:"bold"}},"Select")),o().createElement("div",{className:"nft-info"},o().createElement("img",{src:e.image||"/default-nft-image.svg",alt:e.name||"NFT",className:"nft-image",onError:function(e){e.target.src="/default-nft-image.svg"}}),o().createElement("div",{className:"nft-details"},o().createElement("div",{className:"nft-name"},e.name||"NFT ".concat(e.mint.slice(0,8),"...")),e.collection&&o().createElement("div",{className:"nft-collection"},e.collection))),!M&&o().createElement("button",{className:"burn-button",onClick:function(t){t.stopPropagation(),be(e)}},"Burn"))})),!F&&0===w.length&&o().createElement("div",{className:"no-assets-message"},"No NFTs found in this wallet"))),o().createElement("div",{className:"asset-section"},o().createElement("h3",null,"Compressed NFTs ",C&&o().createElement("span",{className:"loading-indicator"},"Loading...")),o().createElement("div",{className:"cnfts-grid"},x.map((function(e){return o().createElement("div",{key:e.mint,className:"nft-card ".concat(M&&L.includes(e.mint)?"selected":""),"data-mint":e.mint,"data-asset-id":e.mint,onClick:M?function(){return t=e.mint,void G((function(e){return e.includes(t)?e.filter((function(e){return e!==t})):[].concat(mt(e),[t])}));var t}:void 0},o().createElement("div",{className:"nft-info"},o().createElement("img",{src:e.image||"/default-nft-image.svg",alt:e.name||"cNFT",className:"nft-image",onError:function(e){e.target.src="/default-nft-image.svg"}}),o().createElement("div",{className:"nft-details"},o().createElement("div",{className:"nft-name"},e.name||"cNFT ".concat(e.mint.slice(0,8),"...")),e.collection&&o().createElement("div",{className:"nft-collection"},e.collection))),!M&&o().createElement("div",{className:"cnft-info-badge",title:"cNFTs are view-only - no burning functionality available"},"👁️ View Only"))})),!C&&0===x.length&&o().createElement("div",{className:"no-assets-message"},"No compressed NFTs found in this wallet")))),ee&&re&&o().createElement(fe,{isOpen:ee,onClose:function(){return te(!1)},assetId:re.id,assetName:re.name,assetImage:re.image||"../../default-nft-image.svg",onSuccess:ye,onError:function(e){console.error("[WalletAssets] Direct trash operation error:",e),window.debugInfo&&(window.debugInfo.lastCnftError=e,window.debugInfo.lastCnftSuccess=!1)}}),me&&he&&o().createElement(Le,{isOpen:me,onClose:function(){return pe(!1)},assetId:he.id,assetName:he.name,assetImage:he.image||"../../default-nft-image.svg",onSuccess:ye}),se&&le&&le.length>0&&o().createElement(Fe,{isOpen:se,onClose:function(){return ie(!1)},selectedAssets:le,wallet:a?a.toString():"",onSuccess:function(){console.log("[WalletAssets] Queue transfer completed"),a&&(console.log("[WalletAssets] Refreshing all wallet assets"),window.location.reload()),G([]),ie(!1),setTimeout((function(){ue([])}),500),Y(!1)}}))},Ot=function(){return o().createElement("div",{className:"assets-container"},o().createElement(Bt,null))};function jt(e){return jt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jt(e)}function Rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_t(r.key),r)}}function _t(e){var t=function(e){if("object"!=jt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=jt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==jt(t)?t:t+""}function Mt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Mt=function(){return!!e})()}function Dt(e){return Dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Dt(e)}function Wt(e,t){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wt(e,t)}const Ut=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t,n){return t=Dt(t),function(e,t){if(t&&("object"==jt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mt()?Reflect.construct(t,n||[],Dt(e).constructor):t.apply(e,n))}(this,t,[e])).state={hasError:!1},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wt(e,t)}(t,e),n=t,a=[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}],(r=[{key:"componentDidCatch",value:function(e,t){console.error("Error caught by boundary:",e,t),this.setState({error:e,errorInfo:t}),"undefined"!=typeof window&&"localhost"!==window.location.hostname&&console.error("Production error:",{error:e,errorInfo:t})}},{key:"render",value:function(){var e,t;return this.state.hasError?this.props.fallback?this.props.fallback:o().createElement("div",{style:{padding:"20px",margin:"20px",backgroundColor:"#fee",border:"1px solid #fcc",borderRadius:"8px",color:"#c33"}},o().createElement("h2",null,"Something went wrong"),o().createElement("p",null,"We're sorry, but something unexpected happened. Please try refreshing the page."),o().createElement("details",{style:{marginTop:"10px"}},o().createElement("summary",null,"Technical details"),o().createElement("pre",{style:{fontSize:"12px",overflow:"auto",maxHeight:"200px",backgroundColor:"#f5f5f5",padding:"10px",marginTop:"10px"}},null===(e=this.state.error)||void 0===e?void 0:e.toString(),null===(t=this.state.errorInfo)||void 0===t?void 0:t.componentStack)),o().createElement("button",{onClick:function(){return window.location.reload()},style:{marginTop:"15px",padding:"8px 16px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"}},"Refresh Page")):this.props.children}}])&&Rt(n.prototype,r),a&&Rt(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,a}(r.Component);var Kt=function(){return console.log("[App] Rendering main App component"),o().createElement(Ut,null,o().createElement("div",{className:"app-container"},o().createElement(s.default,null,o().createElement("div",{className:"content"},o().createElement("div",{className:"main-header"},o().createElement("img",{src:"/static/solburnt-logo-pixel.png",alt:"Solburnt",className:"main-logo",style:{height:"150px",marginRight:"25px",filter:"drop-shadow(0 0 15px rgba(255, 100, 0, 0.4))",imageRendering:"pixelated"}}),o().createElement("div",{className:"brand-text"},o().createElement("h1",{className:"brand-title"},"Solburnt"),o().createElement("p",{className:"brand-slogan"},"helping you get your sol back"))),o().createElement(Ot,null)))))};console.log("[App] Script loaded, setting up window.App"),window.debugInfo={lastCnftError:null,lastCnftData:null,cnftBurnTriggered:!1,walletInfo:null},console.log("[App] Debug object initialized"),window.App={render:function(){console.log("[App] window.App.render called"),function(){console.log("[App] Initializing application");var e=document.getElementById("app");if(e)try{console.log("[App] Creating React root");var t=(0,a.createRoot)(e);console.log("[App] Rendering React application"),t.render(o().createElement(o().StrictMode,null,o().createElement(Kt,null))),console.log("[App] React application rendered successfully")}catch(e){console.error("[App] Fatal: Failed to render React application:",e)}else console.error("[App] Fatal: Root element #app not found in DOM")}()}};const Ht=Kt},39082:(e,t,n)=>{"use strict";n.d(t,{default:()=>f});var r=n(96540),o=n.n(r),a=n(17812),s=n(44690),i=n(38619),c=n(47971),l=n(13364);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n(91082);var d=function(){var e=(0,s.vT)();return(0,r.useEffect)((function(){var t,n,r,o,a,s;console.log("[WalletLogger] Wallet state updated:",{connected:e.connected,publicKey:(null===(t=e.publicKey)||void 0===t?void 0:t.toString())||"none",adapterName:(null===(n=e.wallet)||void 0===n?void 0:n.adapter.name)||"none",readyState:null===(r=e.wallet)||void 0===r?void 0:r.adapter.readyState}),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.walletInfo={connected:e.connected,publicKey:(null===(o=e.publicKey)||void 0===o?void 0:o.toString())||"none",adapterName:(null===(a=e.wallet)||void 0===a?void 0:a.adapter.name)||"none",readyState:null===(s=e.wallet)||void 0===s?void 0:s.adapter.readyState,hasSignTransaction:!!e.signTransaction})}),[e.connected,e.publicKey,e.wallet,e.signTransaction]),null};const f=function(e){var t=e.children;console.log("WalletProvider component initializing");var n,f,m=a.BX.Mainnet,p=(n=(0,r.useState)((0,l.clusterApiUrl)(m)),f=2,function(e){if(Array.isArray(e))return e}(n)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return i}}(n,f)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(e,t):void 0}}(n,f)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),g=p[0],h=p[1];(0,r.useEffect)((function(){console.log("[WalletProvider] Fetching RPC config"),fetch("/api/config").then((function(e){return e.json()})).then((function(e){e.quicknodeRpcUrl?(console.log("[WalletProvider] Using QuickNode RPC endpoint"),h(e.quicknodeRpcUrl)):(console.log("[WalletProvider] Using public RPC endpoint:",m),h((0,l.clusterApiUrl)(m)))})).catch((function(e){console.error("[WalletProvider] Error fetching config:",e),console.log("[WalletProvider] Falling back to public RPC"),h((0,l.clusterApiUrl)(m))}))}),[m]),(0,r.useMemo)((function(){console.log("Creating Solana connection to:",m);try{var e=new l.Connection(g,"confirmed");return console.log("Solana connection created successfully"),e}catch(e){return console.error("Error creating Solana connection:",e),console.log("Falling back to public RPC endpoint"),new l.Connection((0,l.clusterApiUrl)(m),"confirmed")}}),[g]);var w=(0,r.useMemo)((function(){return console.log("Initializing wallet adapters"),[new i.cE,new i.ds,new i.Ge]}),[]);return console.log("Rendering WalletProvider component structure"),o().createElement(s.Sg,{endpoint:g},o().createElement(s.rh,{wallets:w,autoConnect:!0,onError:function(e){console.error("[WalletProvider] Wallet adapter error:",e),"undefined"!=typeof window&&window.debugInfo&&(window.debugInfo.lastCnftError="Wallet adapter error: ".concat(e.message))}},o().createElement(c.IF,null,o().createElement(d,null),o().createElement("div",{className:"wallet-container"},o().createElement("div",{className:"wallet-buttons"},o().createElement(c.xO,null),o().createElement(c.SH,{style:{marginLeft:"10px"}})),t))))}},42564:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var r=n(31601),o=n.n(r),a=n(76314),s=n.n(a)()(o());s.push([e.id,"/* Robust Transfer Modal Styles */\n.robust-transfer-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.8);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 1000;\n  animation: fadeIn 0.3s ease-in-out;\n}\n\n.robust-transfer-container {\n  background: #1a1a1a;\n  border-radius: 12px;\n  padding: 24px;\n  width: 90%;\n  max-width: 500px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);\n  color: #fff;\n  animation: slideIn 0.3s ease-out;\n}\n\n.robust-modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 16px;\n  padding-bottom: 16px;\n  border-bottom: 1px solid #333;\n}\n\n.robust-modal-header h2 {\n  font-size: 1.5rem;\n  font-weight: 600;\n  margin: 0;\n  color: #fff;\n}\n\n.robust-modal-close {\n  background: none;\n  border: none;\n  color: #999;\n  font-size: 1.5rem;\n  cursor: pointer;\n  transition: color 0.2s;\n}\n\n.robust-modal-close:hover {\n  color: #fff;\n}\n\n.robust-modal-content {\n  margin-bottom: 24px;\n}\n\n.robust-asset-info {\n  display: flex;\n  align-items: center;\n  margin-bottom: 16px;\n  background: rgba(255, 255, 255, 0.05);\n  padding: 12px;\n  border-radius: 8px;\n}\n\n.robust-asset-image {\n  width: 60px;\n  height: 60px;\n  border-radius: 8px;\n  margin-right: 16px;\n  object-fit: cover;\n  background: #333;\n}\n\n.robust-asset-details {\n  flex: 1;\n}\n\n.robust-asset-name {\n  font-weight: 600;\n  margin-bottom: 4px;\n  color: #fff;\n  font-size: 1.1rem;\n}\n\n.robust-asset-id {\n  color: #999;\n  font-size: 0.8rem;\n  word-break: break-all;\n}\n\n.robust-explanation {\n  background: rgba(255, 127, 80, 0.1);\n  border-left: 4px solid coral;\n  padding: 12px;\n  margin-bottom: 16px;\n  border-radius: 4px;\n  font-size: 0.9rem;\n  line-height: 1.5;\n}\n\n.robust-input-group {\n  margin-bottom: 16px;\n}\n\n.robust-input-group label {\n  display: block;\n  margin-bottom: 8px;\n  font-weight: 500;\n  color: #ccc;\n}\n\n.robust-input-group input {\n  width: 100%;\n  padding: 12px;\n  background: #333;\n  border: 1px solid #444;\n  color: #fff;\n  border-radius: 6px;\n  font-family: monospace;\n  font-size: 0.9rem;\n}\n\n.robust-buttons {\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n}\n\n.robust-buttons button {\n  padding: 10px 24px;\n  border-radius: 6px;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.robust-cancel-button {\n  background: transparent;\n  border: 1px solid #555;\n  color: #ccc;\n}\n\n.robust-cancel-button:hover {\n  background: rgba(255, 255, 255, 0.05);\n  border-color: #777;\n  color: #fff;\n}\n\n.robust-transfer-button {\n  background: linear-gradient(45deg, #ff8126, #ff4f59);\n  border: none;\n  color: white;\n}\n\n.robust-transfer-button:hover {\n  background: linear-gradient(45deg, #ff9040, #ff6070);\n  transform: translateY(-1px);\n}\n\n.robust-transfer-button:disabled,\n.robust-cancel-button:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.robust-loader {\n  display: inline-block;\n  width: 20px;\n  height: 20px;\n  margin-right: 8px;\n  border: 3px solid rgba(255, 255, 255, 0.3);\n  border-radius: 50%;\n  border-top-color: white;\n  animation: spin 1s linear infinite;\n}\n\n.robust-status {\n  margin-top: 16px;\n  padding: 12px;\n  border-radius: 6px;\n  font-size: 0.9rem;\n}\n\n.robust-status.error {\n  background: rgba(255, 70, 70, 0.1);\n  border: 1px solid rgba(255, 70, 70, 0.5);\n  color: #ff4646;\n}\n\n.robust-status.success {\n  background: rgba(70, 255, 120, 0.1);\n  border: 1px solid rgba(70, 255, 120, 0.5);\n  color: #4dff78;\n}\n\n.robust-status.processing {\n  background: rgba(70, 170, 255, 0.1);\n  border: 1px solid rgba(70, 170, 255, 0.5);\n  color: #46aaff;\n}\n\n.robust-explorer-link {\n  display: inline-block;\n  margin-top: 8px;\n  color: #46aaff;\n  text-decoration: underline;\n}\n\n@keyframes fadeIn {\n  from { opacity: 0; }\n  to { opacity: 1; }\n}\n\n@keyframes slideIn {\n  from { transform: translateY(-20px); opacity: 0; }\n  to { transform: translateY(0); opacity: 1; }\n}\n\n@keyframes spin {\n  to { transform: rotate(360deg); }\n}",""]);const i=s},45447:()=>{},47790:()=>{},50477:()=>{},51069:()=>{},64688:()=>{},66089:()=>{},71281:()=>{},73776:()=>{},77965:()=>{},78982:()=>{},79368:()=>{},79838:()=>{},81119:()=>{},92668:()=>{}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=a,i.amdO={},e=[],i.O=(t,n,r,o)=>{if(!n){var a=1/0;for(u=0;u<e.length;u++){for(var[n,r,o]=e[u],s=!0,c=0;c<n.length;c++)(!1&o||a>=o)&&Object.keys(i.O).every((e=>i.O[e](n[c])))?n.splice(c--,1):(s=!1,o<a&&(a=o));if(s){e.splice(u--,1);var l=r();void 0!==l&&(t=l)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);i.r(o);var a={};t=t||[null,n({}),n([]),n(n)];for(var s=2&r&&e;"object"==typeof s&&!~t.indexOf(s);s=n(s))Object.getOwnPropertyNames(s).forEach((t=>a[t]=()=>e[t]));return a.default=()=>e,i.d(o,a),o},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r={},o="workspace:",i.l=(e,t,n,a)=>{if(r[e])r[e].push(t);else{var s,c;if(void 0!==n)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==o+n){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",o+n),s.src=e),r[e]=[t];var f=(t,n)=>{s.onerror=s.onload=null,clearTimeout(m);var o=r[e];if(delete r[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(n))),t)return t(n)},m=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),i.j=524,i.p="/static/dist/",(()=>{var e={77:0,147:0,459:0,477:0,524:0};i.f.j=(t,n)=>{var r=i.o(e,t)?e[t]:void 0;if(0!==r)if(r)n.push(r[2]);else{var o=new Promise(((n,o)=>r=e[t]=[n,o]));n.push(r[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(n=>{if(i.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+t,t)}},i.O.j=t=>0===e[t];var t=(t,n)=>{var r,o,[a,s,c]=n,l=0;if(a.some((t=>0!==e[t]))){for(r in s)i.o(s,r)&&(i.m[r]=s[r]);if(c)var u=c(i)}for(t&&t(n);l<a.length;l++)o=a[l],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(u)},n=self.webpackChunkworkspace=self.webpackChunkworkspace||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.nc=void 0;var c=i.O(void 0,[185,96],(()=>i(36561)));c=i.O(c),window.app=c})();